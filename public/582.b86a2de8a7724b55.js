"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[582],{1582:(re,h,o)=>{o.r(h),o.d(h,{UserModule:()=>ie});var u=o(6895),d=o(9938),Z=o(9302),c=o(4006),f=o(5412),A=o(8372),T=o(5e3),e=o(4650),_=o(8606),U=o(3263),F=o(2510),x=o(6964),v=o(9549),I=o(4144),C=o(4859),y=o(3683);function N(i,s){1&i&&(e.TgZ(0,"mat-label"),e._uU(1,"Name"),e.qZA())}function J(i,s){if(1&i&&(e.TgZ(0,"mat-form-field"),e._UZ(1,"input",15),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("value",null==t.userDetails?null:t.userDetails.fullName)}}function M(i,s){1&i&&(e.TgZ(0,"mat-label"),e._uU(1,"Role"),e.qZA())}function L(i,s){if(1&i&&(e.TgZ(0,"mat-form-field"),e._UZ(1,"input",15),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("value",null==t.userDetails?null:t.userDetails.role)}}function Y(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function D(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Email already exists. "),e.qZA())}function S(i,s){1&i&&(e.TgZ(0,"mat-error"),e._uU(1," Invalid Email. "),e.qZA())}function O(i,s){1&i&&e._UZ(0,"span",22)}function w(i,s){1&i&&(e.TgZ(0,"span",23),e._uU(1,"Loading..."),e.qZA())}function q(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.hij(" ",null!=t.userDetails&&t.userDetails._id?"Reinvite":"Invite","")}}function Q(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.inviteUser())}),e.YNc(1,O,1,0,"span",20),e.YNc(2,w,2,0,"span",21),e.YNc(3,q,2,1,"span",11),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("disabled",t.inviteUserForm.invalid||t.apiCallActive),e.xp6(1),e.Q6J("ngIf",t.apiCallActive),e.xp6(1),e.Q6J("ngIf",t.apiCallActive),e.xp6(1),e.Q6J("ngIf",!t.apiCallActive)}}function E(i,s){if(1&i&&(e.TgZ(0,"mat-toolbar",16)(1,"div",17),e.YNc(2,Q,4,4,"button",18),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.userDetails.isSignedUp)}}let V=(()=>{class i{constructor(t,n,r,l,a,m,ne){this.matDialog=t,this.data=n,this.apiService=r,this.errorHandlingService=l,this.matcher=a,this.fb=m,this.alertService=ne,this.userDetails={},this.apiCallActive=!1,this.isViewOnly=!1,this.userDetails=n.user,this.inviteUserForm=this.fb.group({email:[n?.user?.email||"",[c.kI.required,c.kI.pattern(T.c.emailValidator.pattern)]]}),this.inviteUserForm.controls.email.valueChanges.pipe((0,A.b)(500)).subscribe({next:se=>{this.checkEmailUniqueness()}})}ngOnInit(){}inviteUser(){if(this.inviteUserForm.valid){this.apiCallActive=!0;let t={email:this.inviteUserForm.value.email},n=d.d.inviteUser;!this.userDetails?.isSignedUp&&this.userDetails?._id&&(n=d.d.reinviteUser,t._id=this.userDetails?._id),this.apiService.post(n,t).subscribe({next:r=>{this.matDialog.close(r),this.alertService.notify(r.message)},error:r=>{this.errorHandlingService.handle(r)},complete:()=>{this.apiCallActive=!1}})}}checkEmailUniqueness(){let t=this.inviteUserForm.controls.email;t.valid&&t.value.trim()&&t.value.trim()!=this.userDetails?.email&&(this.apiCallActive=!0,this.apiService.get(d.d.checkEmailUniqueness+t.value.trim().toLowerCase()).subscribe({next:n=>{this.apiCallActive=!1,!1===n.isUnique?t.setErrors({not_unique:!0}):this.inviteUserForm.controls.email.errors&&delete this.inviteUserForm.controls.email.errors.not_unique},error:n=>{this.apiCallActive=!1,this.errorHandlingService.handle(n)}}))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.so),e.Y36(f.WI),e.Y36(_.a),e.Y36(U.r),e.Y36(F.d),e.Y36(c.qu),e.Y36(x.c))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-invite-user-form"]],decls:25,vars:14,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],[1,"mat-button-wrapper","cursor-pointer",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","12","cy","12","r","10","stroke","#8F8F8F","stroke-width","1.5"],["d","M14.5 9.49999L9.5 14.5M9.49998 9.49997L14.5 14.4999","stroke","#8F8F8F","stroke-width","1.5","stroke-linecap","round"],["fxLayout","column",1,"content","mt-15"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],[4,"ngIf"],["fxFlex","100"],["type","text","matInput","","formControlName","email","trim","","autocomplete","off",3,"errorStateMatcher","readonly"],["class","mat-accent-bg m-0","fxLayoutAlign","center",4,"ngIf"],["type","text","matInput","","readonly","",3,"value"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["class","sr-only",4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"sr-only"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"span",4),e.NdJ("click",function(){return n.matDialog.close()}),e.O4$(),e.TgZ(6,"svg",5),e._UZ(7,"circle",6)(8,"path",7),e.qZA()()()(),e.kcU(),e.TgZ(9,"div",8)(10,"form",9)(11,"div",10),e.YNc(12,N,2,0,"mat-label",11),e.YNc(13,J,2,1,"mat-form-field",11),e.YNc(14,M,2,0,"mat-label",11),e.YNc(15,L,2,1,"mat-form-field",11),e.TgZ(16,"div",10)(17,"mat-label"),e._uU(18,"Email "),e.qZA(),e.TgZ(19,"mat-form-field",12),e._UZ(20,"input",13),e.YNc(21,Y,2,0,"mat-error",11),e.YNc(22,D,2,0,"mat-error",11),e.YNc(23,S,2,0,"mat-error",11),e.qZA()()()()(),e.YNc(24,E,3,1,"mat-toolbar",14),e.qZA()),2&t&&(e.xp6(4),e.Oqu(null!=n.userDetails&&n.userDetails.isSignedUp?"User Details":null!=n.userDetails&&n.userDetails._id?"Reinvite User":"Invite User"),e.xp6(6),e.Q6J("formGroup",n.inviteUserForm),e.xp6(2),e.Q6J("ngIf",n.userDetails.fullName),e.xp6(1),e.Q6J("ngIf",n.userDetails.fullName),e.xp6(1),e.Q6J("ngIf",n.userDetails.role),e.xp6(1),e.Q6J("ngIf",n.userDetails.role),e.xp6(4),e.ekj("mb-10",n.inviteUserForm.controls.email.touched&&n.inviteUserForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("errorStateMatcher",n.matcher)("readonly",null==n.userDetails?null:n.userDetails.isSignedUp),e.xp6(1),e.Q6J("ngIf",n.inviteUserForm.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",!n.inviteUserForm.controls.email.hasError("required")&&!n.inviteUserForm.controls.email.hasError("pattern")&&n.inviteUserForm.controls.email.hasError("not_unique")),e.xp6(1),e.Q6J("ngIf",!n.inviteUserForm.controls.email.hasError("required")&&n.inviteUserForm.controls.email.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",!n.isViewOnly))},dependencies:[u.O5,v.TO,v.KE,v.hX,I.Nt,C.lW,y.Ye,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u]}),i})();var b=o(9299),p=o(3546),k=o(4850),P=o(7392),g=o(8255);function H(i,s){1&i&&(e.TgZ(0,"p",10),e._uU(1," There is no User created yet!\n"),e.qZA())}function R(i,s){1&i&&(e.TgZ(0,"button",22),e._uU(1,"Active"),e.qZA())}function $(i,s){1&i&&(e.TgZ(0,"button",23),e._uU(1,"Deactivated"),e.qZA())}function j(i,s){1&i&&(e.TgZ(0,"button",23),e._uU(1,"Pending Verification"),e.qZA())}function B(i,s){1&i&&(e.TgZ(0,"button",24),e._uU(1,"Invitation sent"),e.qZA())}function G(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=r.index,a=r.$implicit,m=e.oxw();return e.KtG(m.openConfirmDialog(l,a,{isActive:!a.isActive}))}),e._uU(1),e.qZA()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu((t.isActive?"Deactivate":"Activate")+" user")}}function K(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=r.index,a=r.$implicit,m=e.oxw();return e.KtG(m.openConfirmDialog(l,a,{isVerified:!a.isVerified}))}),e._uU(1,"Verify user"),e.qZA()}}function W(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"mat-card",11)(1,"mat-card-header")(2,"mat-card-title"),e._uU(3),e.ALo(4,"titlecase"),e.qZA(),e.TgZ(5,"mat-card-subtitle"),e._uU(6),e.qZA()(),e.TgZ(7,"mat-card-actions"),e.YNc(8,R,2,0,"button",12),e.YNc(9,$,2,0,"button",13),e.YNc(10,j,2,0,"button",13),e.YNc(11,B,2,0,"button",14),e.TgZ(12,"a",15),e.O4$(),e.TgZ(13,"svg",16),e._UZ(14,"rect",17)(15,"path",18),e.qZA()(),e.kcU(),e.TgZ(16,"mat-menu",null,19)(18,"button",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,a=e.oxw();return e.KtG(a.openUserInviteForm(!0,l))}),e._uU(19),e.qZA(),e.YNc(20,G,2,1,"button",21),e.YNc(21,K,2,0,"button",21),e.TgZ(22,"button",20),e.NdJ("click",function(){const r=e.CHM(t),l=r.index,a=r.$implicit,m=e.oxw();return e.KtG(m.openConfirmDialog(l,a,{isDeleted:!a.isDeleted}))}),e._uU(23,"Delete user"),e.qZA()()()()}if(2&i){const t=s.$implicit,n=e.MAs(17);e.xp6(3),e.Oqu(e.lcZ(4,10,null!=t&&t.firstName?(null==t?null:t.firstName)+" "+(null==t?null:t.lastName):null==t?null:t.fullName)),e.xp6(3),e.hij("",t.email," "),e.xp6(2),e.Q6J("ngIf",t.isActive&&t.isSignedUp),e.xp6(1),e.Q6J("ngIf",!t.isActive&&t.isSignedUp&&t.isVerified),e.xp6(1),e.Q6J("ngIf",!t.isActive&&t.isSignedUp&&!t.isVerified),e.xp6(1),e.Q6J("ngIf",t.isActive&&!t.isSignedUp),e.xp6(1),e.Q6J("matMenuTriggerFor",n),e.xp6(7),e.Oqu(t.isActive&&!t.isSignedUp?"Reinvite":"View"),e.xp6(1),e.Q6J("ngIf",t.isSignedUp&&t.isVerified),e.xp6(1),e.Q6J("ngIf",t.isSignedUp&&!t.isVerified)}}let z=(()=>{class i{constructor(t,n,r,l,a){this.apiService=t,this.dialog=n,this.errorHandlingService=r,this.alertService=l,this.activeRoute=a,this.users=[],this.apiCallActive=!0,this.displayedColumns=["id","fullName","email","isSignedUp","action"],this.activeRoute.params.subscribe({next:m=>{this.getUsers()}})}ngOnInit(){}openConfirmDialog(t,n,r){this.addUserDialogRef=this.dialog.open(Z.$,{minWidth:"320px",width:"585px",disableClose:!0,data:{actionData:r,user:n,heading:(null!=r.isActive||null!=r.isActive?n.isActive?"Deactivate":"Activate":null!=r.isVerified||null!=r.isVerified?"Verify":"Delete")+" User",message:"Are you sure you want to "+(null!=r.isActive||null!=r.isActive?n.isActive?"deactivate":"activate":null!=r.isVerified||null!=r.isVerified?"verify":"delete")+" this user?"}}),this.addUserDialogRef.afterClosed().subscribe({next:l=>{l&&this.manageUser(t,n,r)}})}openUserInviteForm(t,n={}){this.addUserDialogRef=this.dialog.open(V,{minWidth:"320px",width:"585px",disableClose:!0,data:{isViewOnly:t,user:n}}),this.addUserDialogRef.afterClosed().subscribe({next:r=>{r&&this.getUsers()}})}getUsers(){this.apiCallActive=!0,this.apiService.get(d.d.user).subscribe({next:t=>{this.apiCallActive=!1,this.users=t.users||[]},error:t=>{this.apiCallActive=!1,this.errorHandlingService.handle(t)}})}manageUser(t,n,r){console.log("manageUserAccess = ",r),this.apiService.put(d.d.manageUserAccess,{email:n.email,...r}).subscribe({next:l=>{r.isDeleted?this.users.splice(t,1):this.users[t].isActive=!this.users[t].isActive,this.alertService.notify(l.message)},error:l=>this.errorHandlingService.handle(l)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(_.a),e.Y36(f.uw),e.Y36(U.r),e.Y36(x.c),e.Y36(b.gz))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-list"]],decls:15,vars:3,consts:[[1,"title-group"],[1,"title"],[1,"h1"],[1,"line","italic"],[1,"title-buttons"],["mat-raised-button","","color","primary",3,"click"],["fxFlex","1 0",1,""],["class","no-data",4,"ngIf"],[1,"flex","flex-row","gap","mt-10"],["class","example-card ",4,"ngFor","ngForOf"],[1,"no-data"],[1,"example-card"],["class","active-chip",4,"ngIf"],["class","deactivated-chip",4,"ngIf"],["class","disabled-chip",4,"ngIf"],[1,"cursor-pointer",3,"matMenuTriggerFor"],["width","40","height","40","viewBox","0 0 40 40","fill","none","xmlns","http://www.w3.org/2000/svg"],["x","39.5","y","0.5","width","39","height","39","rx","19.5","transform","rotate(90 39.5 0.5)","fill","white","stroke","#F3F3F3"],["fill-rule","evenodd","clip-rule","evenodd","d","M20 10C21.1046 10 22 10.8954 22 12C22 13.1046 21.1046 14 20 14C18.8954 14 18 13.1046 18 12C18 10.8954 18.8954 10 20 10ZM20 18C21.1046 18 22 18.8954 22 20C22 21.1046 21.1046 22 20 22C18.8954 22 18 21.1046 18 20C18 18.8954 18.8954 18 20 18ZM22 28C22 26.8954 21.1046 26 20 26C18.8954 26 18 26.8954 18 28C18 29.1046 18.8954 30 20 30C21.1046 30 22 29.1046 22 28Z","fill","#BFBFBF"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"active-chip"],[1,"deactivated-chip"],[1,"disabled-chip"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3," User List "),e.TgZ(4,"p",3),e._uU(5),e.qZA()()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return n.openUserInviteForm(!1)}),e.TgZ(8,"mat-icon"),e._uU(9,"add"),e.qZA(),e._uU(10," Invite User "),e.qZA()()(),e._UZ(11,"mat-divider",6),e.YNc(12,H,2,0,"p",7),e.TgZ(13,"div",8),e.YNc(14,W,24,12,"mat-card",9),e.qZA()),2&t&&(e.xp6(5),e.hij("",n.users.length," users"),e.xp6(7),e.Q6J("ngIf",!n.apiCallActive&&(null==n.users?null:n.users.length)<=0),e.xp6(2),e.Q6J("ngForOf",n.users))},dependencies:[u.sg,u.O5,p.a8,p.dk,p.n5,p.$j,p.hq,C.lW,k.d,P.Hw,g.VK,g.OP,g.p6,u.rS],styles:["table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;align-content:flex-end}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%]{width:25px}.mat-card.example-card[_ngcontent-%COMP%]{background-color:#fff!important;max-width:33%}"]}),i})();var X=o(4111),ee=o(2102);const te=[{path:"list",component:z},{path:"**",redirectTo:"list"}];let ie=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[b.Bz.forChild(te),u.ez,ee.q,X.q]}),i})()}}]);