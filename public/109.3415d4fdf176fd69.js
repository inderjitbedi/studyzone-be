"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[109],{6109:(Xt,b,r)=>{r.r(b),r.d(b,{PaymentModule:()=>Gt});var m=r(6895),l=r(7155),p=r(9938),t=r(4650),f=r(8606),C=r(3263),x=r(6964),h=r(9299),F=r(4850),P=r(8739),M=r(2498);function O(n,i){1&n&&(t.TgZ(0,"p",6),t._uU(1," There is no transactions made yet!\n"),t.qZA())}function w(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1,"#"),t.qZA())}function U(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=i.index,o=t.oxw(2);t.xp6(1),t.hij(" ",e+1+(o.pagination.page-1)*o.pagination.limit," ")}}function N(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Course Name "),t.qZA())}function k(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e||null==e.course?null:e.course.name)," ")}}function Y(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Promo code applied "),t.qZA())}function q(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e||null==e.coupon?null:e.coupon.name)||"-"," ")}}function S(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Amount "),t.qZA())}function I(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" CA$",(null==e?null:e.amount)||0," ")}}function L(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," User's Name "),t.qZA())}function D(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e||null==e.user?null:e.user.fullName)," ")}}function Q(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Contact Email "),t.qZA())}function J(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"lowercase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e?null:e.email)," ")}}function H(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Transaction Timestamp "),t.qZA())}function V(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.createdAt,"dd MMM yyyy hh:mm a")," ")}}function z(n,i){1&n&&(t.TgZ(0,"th",21),t._uU(1," Status "),t.qZA())}function j(n,i){if(1&n&&(t.TgZ(0,"td",22),t._uU(1),t.ALo(2,"stripestatus"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e?null:e.status)," ")}}function $(n,i){1&n&&t._UZ(0,"tr",23)}function E(n,i){1&n&&t._UZ(0,"tr",24)}const B=function(){return[5,10,25,100]};function R(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"table",7),t.ynx(2,8),t.YNc(3,w,2,0,"th",9),t.YNc(4,U,2,1,"td",10),t.BQk(),t.ynx(5,11),t.YNc(6,N,2,0,"th",9),t.YNc(7,k,3,3,"td",10),t.BQk(),t.ynx(8,12),t.YNc(9,Y,2,0,"th",9),t.YNc(10,q,3,3,"td",10),t.BQk(),t.ynx(11,13),t.YNc(12,S,2,0,"th",9),t.YNc(13,I,2,1,"td",10),t.BQk(),t.ynx(14,14),t.YNc(15,L,2,0,"th",9),t.YNc(16,D,3,3,"td",10),t.BQk(),t.ynx(17,15),t.YNc(18,Q,2,0,"th",9),t.YNc(19,J,3,3,"td",10),t.BQk(),t.ynx(20,16),t.YNc(21,H,2,0,"th",9),t.YNc(22,V,3,4,"td",10),t.BQk(),t.ynx(23,17),t.YNc(24,z,2,0,"th",9),t.YNc(25,j,3,3,"td",10),t.BQk(),t.YNc(26,$,1,0,"tr",18),t.YNc(27,E,1,0,"tr",19),t.qZA(),t.TgZ(28,"mat-paginator",20),t.NdJ("page",function(a){t.CHM(e);const s=t.oxw();return t.KtG(s.onPageChange(a))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns),t.xp6(1),t.Q6J("pageIndex",e.pagination.page-1)("length",e.pagination.total)("pageSize",e.pagination.limit)("pageSizeOptions",t.DdM(7,B))}}let G=(()=>{class n{constructor(e,o,a,s,u){this.apiService=e,this.errorHandlingService=o,this.alertService=a,this.activeRoute=s,this.router=u,this.transactions=[],this.apiCallActive=!0,this.pagination={page:1,limit:10,total:0},this.displayedColumns=["id","coursename","coupon","amount","user","email","createdAt","status"],this.getTransactions()}ngOnInit(){}toQueryString(e){let o="";return Object.keys(e).map((a,s)=>{e[a]&&(o+=0===s?"?":"&",o+=a+"="+e[a])}),o}onPageChange(e){console.log(e),this.pagination.page=e.pageIndex+1,this.pagination.limit=e.pageSize,this.getTransactions()}getTransactions(){this.apiCallActive=!0;let{page:e,limit:o}=this.pagination;this.apiService.get(p.d.getTransaction+this.toQueryString({page:e,limit:o})).subscribe({next:a=>{this.apiCallActive=!1,this.transactions=a.transactions||[],this.pagination.total=a.totalTransactions,this.pagination.page=a.page,this.dataSource=new l.by(a.transactions||[])},error:a=>{this.apiCallActive=!1,this.errorHandlingService.handle(a)}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.a),t.Y36(C.r),t.Y36(x.c),t.Y36(h.gz),t.Y36(h.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment-history"]],decls:7,vars:2,consts:[[1,"title-group"],[1,"title"],[1,"mat-h1"],["fxFlex","1 0"],["class","no-data  flex-center",4,"ngIf"],[4,"ngIf"],[1,"no-data","flex-center"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","coursename"],["matColumnDef","coupon"],["matColumnDef","amount"],["matColumnDef","user"],["matColumnDef","email"],["matColumnDef","createdAt"],["matColumnDef","status"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page",3,"pageIndex","length","pageSize","pageSizeOptions","page"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3," Transactions "),t.qZA()()(),t._UZ(4,"mat-divider",3),t.YNc(5,O,2,0,"p",4),t.YNc(6,R,29,8,"div",5)),2&e&&(t.xp6(5),t.Q6J("ngIf",!o.apiCallActive&&(null==o.dataSource||null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)<=0),t.xp6(1),t.Q6J("ngIf",!o.apiCallActive&&(null==o.dataSource||null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)>0))},dependencies:[m.O5,F.d,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,P.NW,m.gd,m.i8,m.rS,m.uU,M.q],styles:[".mat-tab-nav-bar[_ngcontent-%COMP%]{border:0}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-ink-bar[_ngcontent-%COMP%]{display:none}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-tab-links[_ngcontent-%COMP%]   .mat-tab-link[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#8f8f8f;padding:8px 16px;width:-moz-fit-content;width:fit-content;min-width:-moz-fit-content;min-width:fit-content;margin-right:8px}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-tab-links[_ngcontent-%COMP%]   .mat-tab-link.mat-tab-label-active[_ngcontent-%COMP%]{background:#FFFFFF;box-shadow:0 2px 3px #0000000d;border-radius:8px;color:#1d1d1d}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;padding:8px}.flex-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:50%}.flex-row[_ngcontent-%COMP%]   .title-buttons[_ngcontent-%COMP%]{margin-left:auto}table[_ngcontent-%COMP%]{box-shadow:none;border-top:0}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-radius:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{margin-bottom:10px;font-size:13px;font-weight:700;line-height:22px;color:#3f3f3f;background-color:#f9f9f9}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3), table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){width:150px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4), table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){width:100px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(6), table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6){width:180px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:150px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#fff!important;font-size:12px;font-weight:600;color:#8f8f8f;border-top:0}table[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{line-height:13px;font-size:16px}tr.mat-row[_ngcontent-%COMP%]{border:white solid 4px;border-radius:8px}"]}),n})();var c=r(4006),v=r(5412),K=r(2340),X=r(2510),W=r(529),_=r(9549),tt=r(4144),A=r(4859),et=r(3683),nt=r(4385),ot=r(3238),it=r(455);function at(n,i){if(1&n&&(t.TgZ(0,"mat-option",25),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=i.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.name)," ")}}function rt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Required "),t.qZA())}function lt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Coupon name already exists. "),t.qZA())}function ct(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1," Coupon name can only contain alpha-numeric, as well as the special characters '&' and '-' with no spaces in between. "),t.qZA())}function st(n,i){if(1&n&&(t.TgZ(0,"mat-hint",26),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.AsE("",e.nameMaxLength-e.couponForm.controls.name.value.length," ",e.nameMaxLength-e.couponForm.controls.name.value.length>1?"characters":"character"," left.")}}function ut(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"a",27),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return u.couponForm.controls.valueType.setValue(s.value),t.KtG(u.priceCheck())}),t._uU(1),t.qZA()}if(2&n){const e=i.$implicit,o=t.oxw();t.ekj("active",o.couponForm.controls.valueType.value==e.value),t.xp6(1),t.Oqu(e.name)}}function mt(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Required "),t.qZA())}function pt(n,i){1&n&&(t.TgZ(0,"mat-hint",26),t._uU(1,"Value should be between 1 to 100."),t.qZA())}function dt(n,i){1&n&&(t.TgZ(0,"mat-hint",26),t._uU(1,"Should not exceed the course price left."),t.qZA())}function ht(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij("","percentage"==e.selectedType?"Not a valid percentage value.":"fixed"==e.selectedType?"Only numeric value allowed.":""," ")}}function gt(n,i){if(1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij("Discount Value can't exceed the Course Price (CA$",null==e.selectedCourse?null:e.selectedCourse.price,") ")}}function _t(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",10)(1,"mat-label"),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.TgZ(4,"mat-form-field",13)(5,"input",28),t.NdJ("input",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.priceCheck())}),t.qZA(),t.YNc(6,mt,2,0,"mat-error",15),t.YNc(7,pt,2,0,"mat-hint",16),t.YNc(8,dt,2,0,"mat-hint",16),t.YNc(9,ht,2,1,"mat-error",15),t.YNc(10,gt,2,1,"mat-error",15),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,10,e.selectedType)," Discount Value "),t.xp6(2),t.ekj("mb-10",e.couponForm.controls.value.touched&&e.couponForm.controls.value.hasError("required")),t.xp6(1),t.Q6J("errorStateMatcher",e.matcher)("readonly",e.isViewOnly),t.xp6(1),t.Q6J("ngIf",e.couponForm.controls.value.hasError("required")),t.xp6(1),t.Q6J("ngIf",!e.isViewOnly&&"percentage"==e.selectedType),t.xp6(1),t.Q6J("ngIf",!e.isViewOnly&&"fixed"==e.selectedType),t.xp6(1),t.Q6J("ngIf",e.couponForm.controls.value.hasError("pattern")),t.xp6(1),t.Q6J("ngIf",e.couponForm.controls.value.hasError("max_value"))}}function ft(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Required "),t.qZA())}function Ct(n,i){1&n&&(t.TgZ(0,"mat-error"),t._uU(1,"Only numeric value allowed. "),t.qZA())}function xt(n,i){if(1&n&&(t.TgZ(0,"div",10)(1,"mat-label"),t._uU(2,"Usage Limit "),t.qZA(),t.TgZ(3,"mat-form-field",13),t._UZ(4,"input",29),t.YNc(5,ft,2,0,"mat-error",15),t.YNc(6,Ct,2,0,"mat-error",15),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.ekj("mb-10",e.couponForm.controls.usageLimit.touched&&e.couponForm.controls.usageLimit.hasError("required")),t.xp6(1),t.Q6J("errorStateMatcher",e.matcher)("readonly",e.isViewOnly),t.xp6(1),t.Q6J("ngIf",e.couponForm.controls.usageLimit.hasError("required")),t.xp6(1),t.Q6J("ngIf",e.couponForm.controls.usageLimit.hasError("pattern"))}}function vt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"mat-toolbar",30)(1,"div",31)(2,"button",32),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.saveCoupon())}),t._uU(3,"Save"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.couponForm.invalid||e.apiCallActive)}}let yt=(()=>{class n{constructor(e,o,a,s,u,g,T,Z){this.matDialog=e,this.data=o,this.apiService=a,this.errorHandlingService=s,this.matcher=u,this.fb=g,this.alertService=T,this.http=Z,this.baseUrl=K.N.baseUrl,this.toggle=!1,this.apiCallActive=!1,this.nameMaxLength=50,this.courseList=[],this.color="#039ee3",this.isUnique=!0,this.fileObject={},this.uploadingInProgess=!1,this.attachment=null,this.types=[{value:"free",name:"Free"},{value:"percentage",name:"Percentage"},{value:"fixed",name:"Amount"}],this.selectedCourse=null,this.selectedType="",this.isUnlimited=!1,this.allCourses=[],this.getAllCourses(o),this.isViewOnly=o.isViewOnly,this.couponForm=this.fb.group({course:[o.course||"",c.kI.required],name:[o.name||"",[c.kI.required,c.kI.pattern("^[a-zA-Z0-9&-]*$")]],valueType:[o.valueType||"free",c.kI.required],value:[o.value,c.kI.required],usageLimit:[o.usageLimit||"",[c.kI.required,c.kI.pattern(/^[0-9]+$/)]],status:[null==o.status&&null==o.status||o.status],isUnlimited:[0==o.usageLimit]}),this.typeUpdated(o.valueType||"free"),o._id&&(this.couponId=o._id||null,o.usageLimit||(this.couponForm.controls.isUnlimited.setValue(!0),this.isUnlimited=!0,this.couponForm.controls.usageLimit.setValue(null),this.couponForm.controls.usageLimit.setValidators([]),this.couponForm.controls.usageLimit.updateValueAndValidity())),this.couponForm.controls.isUnlimited.valueChanges.subscribe({next:d=>{this.isUnlimited=d,d?(this.couponForm.controls.usageLimit.setValue(null),this.couponForm.controls.usageLimit.setValidators([]),this.couponForm.controls.usageLimit.updateValueAndValidity()):(this.couponForm.controls.usageLimit.setValidators([c.kI.required,c.kI.pattern(/^[0-9]+$/)]),this.couponForm.controls.usageLimit.updateValueAndValidity())}}),this.couponForm.controls.course.valueChanges.subscribe({next:d=>{this.selectedCourse=this.allCourses.filter(Kt=>Kt._id==d)?.[0]||{}}}),this.couponForm.controls.valueType.valueChanges.subscribe({next:d=>{this.typeUpdated(d)}})}priceCheck(){let e=this.couponForm.controls.value.value;"fixed"===this.selectedType?(console.log(e,this.selectedCourse.price,parseInt(e)>parseInt(this.selectedCourse.price)),e&&this.selectedCourse&&parseInt(e)>parseInt(this.selectedCourse.price)?(this.couponForm.controls.value.setErrors({max_value:!0}),this.couponForm.controls.value.updateValueAndValidity(),console.log("errorr",this.couponForm.get("value"))):this.couponForm.controls.value.errors&&delete this.couponForm.controls.value.errors.max_value):this.couponForm.controls.value.errors&&delete this.couponForm.controls.value.errors.max_value,this.couponForm.controls.value.updateValueAndValidity()}customMaxValueValidator(e){return this.selectedCourse?.price&&e.value>parseInt(this.selectedCourse.price)?{max_value:!0}:null}typeUpdated(e){switch(this.selectedType=e,e){case"percentage":this.setValidators([c.kI.required,c.kI.pattern(/^(100(\.0{1,2})?|\d{0,2}(\.\d{1,2})?)$/)]);break;case"fixed":this.setValidators([c.kI.required,c.kI.pattern(/^[0-9]+$/),this.customMaxValueValidator.bind(this)]);break;default:this.setValidators([])}}setValidators(e){this.couponForm.controls.value.setValidators(e),this.couponForm.controls.value.updateValueAndValidity()}getAllCourses(e){this.apiCallActive=!0,this.apiService.get(p.d.allCourses).subscribe({next:o=>{this.apiCallActive=!1,this.allCourses=o.courses,this.couponForm.controls.course.setValue(e.course?._id),console.log(this.couponForm),this.priceCheck()},error:o=>{this.apiCallActive=!1,this.errorHandlingService.handle(o)}})}checkCouponCategoryUniqueness(){let e=this.couponForm.controls.name,o=this.couponForm.controls.course.value;o&&e.valid&&(this.apiCallActive=!0,this.apiService.get(p.d.checkCouponUniqueness.replace(":id",o)+e.value.trim().toLowerCase()).subscribe({next:a=>{this.apiCallActive=!1,!1===a.isUnique?e.setErrors({not_unique:!0}):this.couponForm.controls.name.errors&&delete this.couponForm.controls.name.errors.not_unique},error:a=>{this.apiCallActive=!1,this.errorHandlingService.handle(a)}}))}ngOnInit(){}saveCoupon(){if(this.couponForm.valid){this.apiCallActive=!0;let e=this.couponForm.value,o={name:e.name.trim().toLowerCase(),valueType:e.valueType,value:e.value,usageLimit:e.usageLimit,status:e.status,course:e.course},a=p.d.createCoupon,s=this.apiService.post(a,o);this.couponId&&(a+="/"+this.couponId,s=this.apiService.put(a,o)),s.subscribe({next:u=>{this.alertService.notify(u.message),this.matDialog.close(u)},error:u=>{this.errorHandlingService.handle(u)},complete:()=>{this.apiCallActive=!1}})}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.so),t.Y36(v.WI),t.Y36(f.a),t.Y36(C.r),t.Y36(X.d),t.Y36(c.qu),t.Y36(x.c),t.Y36(W.eN))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-coupon-form"]],decls:42,vars:21,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],[1,"mat-button-wrapper","cursor-pointer",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["cx","12","cy","12","r","10","stroke","#8F8F8F","stroke-width","1.5"],["d","M14.5 9.49999L9.5 14.5M9.49998 9.49997L14.5 14.4999","stroke","#8F8F8F","stroke-width","1.5","stroke-linecap","round"],["fxLayout","column",1,"content","p-20","mt-20"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],["formControlName","course",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100"],["type","text","matInput","","formControlName","name","trim","","autocomplete","off","maxlength","50",3,"errorStateMatcher","readonly"],[4,"ngIf"],["align","end",4,"ngIf"],[1,"nav","nav-pills","nav-fill"],["class","nav-link ",3,"active","click",4,"ngFor","ngForOf"],["fxLayout","column","fxLayout.gt-xs","row",4,"ngIf"],["fxLayout","column","fxLayout.gt-xs","row",1,"flex-center","mb-15"],["formControlName","isUnlimited","name","enablepublished"],["fxLayout","column","fxLayout.gt-xs","row",1,"flex-center"],["formControlName","status","name","enablepublished"],["class","mat-accent-bg m-0 mt-12","fxLayoutAlign","center",4,"ngIf"],[3,"value"],["align","end"],[1,"nav-link",3,"click"],["type","text","matInput","","formControlName","value","trim","","autocomplete","off","maxlength","10",3,"errorStateMatcher","readonly","input"],["type","text","matInput","","formControlName","usageLimit","trim","","autocomplete","off",3,"errorStateMatcher","readonly"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0","mt-12"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),t._uU(4),t.qZA(),t.TgZ(5,"span",4),t.NdJ("click",function(){return o.matDialog.close()}),t.O4$(),t.TgZ(6,"svg",5),t._UZ(7,"circle",6)(8,"path",7),t.qZA()()()(),t.kcU(),t.TgZ(9,"div",8)(10,"form",9)(11,"div",10)(12,"div",10)(13,"mat-label"),t._uU(14,"Select Course"),t.qZA(),t.TgZ(15,"mat-form-field")(16,"mat-select",11),t.NdJ("selectionChange",function(){return o.priceCheck()}),t.YNc(17,at,3,4,"mat-option",12),t.qZA()()(),t.TgZ(18,"div",10)(19,"mat-label"),t._uU(20,"Coupon Name "),t.qZA(),t.TgZ(21,"mat-form-field",13),t._UZ(22,"input",14),t.YNc(23,rt,2,0,"mat-error",15),t.YNc(24,lt,2,0,"mat-error",15),t.YNc(25,ct,2,0,"mat-error",15),t.YNc(26,st,2,2,"mat-hint",16),t.qZA()(),t.TgZ(27,"div",10)(28,"mat-label"),t._uU(29,"Discount Type"),t.qZA(),t.TgZ(30,"nav",17),t.YNc(31,ut,2,3,"a",18),t._uU(32,"` "),t.qZA()(),t.YNc(33,_t,11,12,"div",19),t.TgZ(34,"div",20),t._uU(35," Unlimited usage"),t._UZ(36,"mat-slide-toggle",21),t.qZA(),t.YNc(37,xt,7,6,"div",19),t.TgZ(38,"div",22),t._uU(39," Active "),t._UZ(40,"mat-slide-toggle",23),t.qZA()()()(),t.YNc(41,vt,4,1,"mat-toolbar",24),t.qZA()),2&e&&(t.xp6(4),t.hij("",o.couponId?"Edit":"Create"," Coupon"),t.xp6(6),t.Q6J("formGroup",o.couponForm),t.xp6(1),t.ekj("form-div",!o.isViewOnly)("mt-30",o.isViewOnly),t.xp6(6),t.Q6J("ngForOf",o.allCourses),t.xp6(4),t.ekj("mb-10",o.couponForm.controls.name.touched&&o.couponForm.controls.name.hasError("required")),t.xp6(1),t.Q6J("errorStateMatcher",o.matcher)("readonly",o.isViewOnly),t.xp6(1),t.Q6J("ngIf",o.couponForm.controls.name.hasError("required")),t.xp6(1),t.Q6J("ngIf",!o.couponForm.controls.name.hasError("required")&&!o.couponForm.controls.name.hasError("pattern")&&o.couponForm.controls.name.hasError("not_unique")),t.xp6(1),t.Q6J("ngIf",!o.couponForm.controls.name.hasError("required")&&o.couponForm.controls.name.hasError("pattern")),t.xp6(1),t.Q6J("ngIf",!o.isViewOnly),t.xp6(5),t.Q6J("ngForOf",o.types),t.xp6(2),t.Q6J("ngIf","free"!=o.selectedType),t.xp6(4),t.Q6J("ngIf",!o.isUnlimited),t.xp6(1),t.ekj("mt-20",o.isUnlimited),t.xp6(3),t.Q6J("ngIf",!o.isViewOnly))},dependencies:[m.sg,m.O5,_.TO,_.KE,_.bx,_.hX,tt.Nt,A.lW,et.Ye,c._Y,c.Fj,c.JJ,c.JL,c.nD,c.sg,c.u,nt.gD,ot.ey,it.Rr,m.rS],styles:[".mat-dialog-container[_ngcontent-%COMP%]{width:100%;padding:24px 32px}.nav[_ngcontent-%COMP%]{margin:16px 0}.nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{background:#fff;border:1px solid #8F8F8F;border-radius:68px;color:#8f8f8f;font-size:12px;font-weight:700;line-height:16px;margin-right:8px;padding:8px 16px;width:-moz-fit-content;width:fit-content;flex:none;cursor:pointer}.nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:#F5F8FF;color:#007aff;border-color:#007aff}.h-150[_ngcontent-%COMP%]{max-height:180px}.h-150[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{height:150px}.c-btn[_ngcontent-%COMP%]{font-style:normal;font-weight:700;font-size:12px;line-height:24px;text-decoration-line:underline;color:#007aff}.info[_ngcontent-%COMP%]{font-family:Inter;font-style:normal;font-weight:500;font-size:12px;line-height:16px;color:#a0a5b0!important}.uploader[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:100%;height:150px;border:1px solid #8F8F8F;display:flex;align-items:center;justify-content:center}.h-50[_ngcontent-%COMP%]{height:50px!important}progress[_ngcontent-%COMP%]::-webkit-progress-value{background:#007AFF}progress[_ngcontent-%COMP%]{color:#007aff}progress[_ngcontent-%COMP%]::-moz-progress-bar{background:#007AFF}"]}),n})();var Tt=r(9302),Zt=r(7392),y=r(8255);function bt(n,i){1&n&&(t.TgZ(0,"p",9),t._uU(1," There is no promo code created yet!\n"),t.qZA())}function Ft(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1,"#"),t.qZA())}function At(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&n){const e=i.index;t.xp6(1),t.hij(" ",e+1," ")}}function Pt(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Code "),t.qZA())}function Mt(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e?null:e.name)," ")}}function Ot(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Course Name "),t.qZA())}function wt(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null==e||null==e.course?null:e.course.name)," ")}}function Ut(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Discount Value "),t.qZA())}function Nt(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ","fixed"===(null==e?null:e.valueType)?"CA$"+(null==e?null:e.value):"percentage"===(null==e?null:e.valueType)?(null==e?null:e.value)+"%":"Free"," ")}}function kt(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Usage Limit "),t.qZA())}function Yt(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",null!=e&&e.usageLimit?(null==e?null:e.usageLimit)+"X":"Unlimited"," ")}}function qt(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Usage Counter "),t.qZA())}function St(n,i){if(1&n&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" ",null==e?null:e.usageCounter," ")}}function It(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Status "),t.qZA())}function Lt(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"Inactive"),t.qZA())}function Dt(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1,"Active"),t.qZA())}function Qt(n,i){if(1&n&&(t.TgZ(0,"td",24),t.YNc(1,Lt,2,0,"span",8),t.YNc(2,Dt,2,0,"span",8),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.Q6J("ngIf",!e.status),t.xp6(1),t.Q6J("ngIf",e.status)}}function Jt(n,i){1&n&&(t.TgZ(0,"th",23),t._uU(1," Actions "),t.qZA())}function Ht(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"td",24)(1,"a",25),t.O4$(),t.TgZ(2,"svg",26),t._UZ(3,"rect",27)(4,"path",28),t.qZA()(),t.kcU(),t.TgZ(5,"mat-menu",null,29)(7,"button",30),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw(2);return t.KtG(u.openAddCouponForm(!1,s))}),t._uU(8,"Edit"),t.qZA(),t.TgZ(9,"button",30),t.NdJ("click",function(){const a=t.CHM(e),s=a.index,u=a.$implicit,g=t.oxw(2);return t.KtG(g.delete(s,u))}),t._uU(10,"Delete"),t.qZA()()()}if(2&n){const e=t.MAs(6);t.xp6(1),t.Q6J("matMenuTriggerFor",e)}}function Vt(n,i){1&n&&t._UZ(0,"tr",31)}function zt(n,i){1&n&&t._UZ(0,"tr",32)}function jt(n,i){if(1&n&&(t.TgZ(0,"div")(1,"table",10),t.ynx(2,11),t.YNc(3,Ft,2,0,"th",12),t.YNc(4,At,2,1,"td",13),t.BQk(),t.ynx(5,14),t.YNc(6,Pt,2,0,"th",12),t.YNc(7,Mt,3,3,"td",13),t.BQk(),t.ynx(8,15),t.YNc(9,Ot,2,0,"th",12),t.YNc(10,wt,3,3,"td",13),t.BQk(),t.ynx(11,16),t.YNc(12,Ut,2,0,"th",12),t.YNc(13,Nt,2,1,"td",13),t.BQk(),t.ynx(14,17),t.YNc(15,kt,2,0,"th",12),t.YNc(16,Yt,2,1,"td",13),t.BQk(),t.ynx(17,18),t.YNc(18,qt,2,0,"th",12),t.YNc(19,St,2,1,"td",13),t.BQk(),t.ynx(20,19),t.YNc(21,It,2,0,"th",12),t.YNc(22,Qt,3,2,"td",13),t.BQk(),t.ynx(23,20),t.YNc(24,Jt,2,0,"th",12),t.YNc(25,Ht,11,1,"td",13),t.BQk(),t.YNc(26,Vt,1,0,"tr",21),t.YNc(27,zt,1,0,"tr",22),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let $t=(()=>{class n{constructor(e,o,a,s,u,g,T){this.apiService=e,this.dialog=o,this.errorHandlingService=a,this.alertService=s,this.activeRoute=u,this.router=g,this._location=T,this.apiCallActive=!0,this.currentUrl="",this.activeLinkIndex=-1,this.coupons=[],this.displayedColumns=["id","name","coursename","value","usageLimit","usageCounter","status","actions"],this.activeRoute.params.subscribe({next:({type:Z})=>{this.currentUrl=this.router.url,this.getCoupons(Z)}}),this.navLinks=[{label:"Paid",link:"/dashboard/payment/coupon/paid",index:2}]}updateUrl(e){this._location.go(e.link),this.currentUrl=e.link,this.getCoupons(e.label.toLowerCase())}ngOnInit(){this.router.routeReuseStrategy.shouldReuseRoute=()=>!1}delete(e,o){this.openConfirmDialog(e,o,{course:o,heading:"Delete coupon",type:"delete",message:"Are you sure you want to delete this coupon?"})}openConfirmDialog(e,o,a={}){this.addCourseDialogRef=this.dialog.open(Tt.$,{minWidth:"320px",width:"585px",disableClose:!0,data:a}),this.addCourseDialogRef.afterClosed().subscribe({next:s=>{s&&"delete"==a.type&&this.deleteCourse(e,o)}})}deleteCourse(e,o){this.apiService.put(p.d.deleteCoupon.replace(":id",o._id),{isDeleted:!0}).subscribe({next:a=>{this.coupons.splice(e,1),this.dataSource=new l.by(this.coupons||[]),this.alertService.notify(a.message)},error:a=>this.errorHandlingService.handle(a)})}getCoupons(e="paid"){this.apiCallActive=!0,this.apiService.get(p.d.coupon.replace(":type",e)).subscribe({next:o=>{this.apiCallActive=!1,this.coupons=o.coupons||[],this.dataSource=new l.by(o.coupons||[])},error:o=>{this.apiCallActive=!1,this.errorHandlingService.handle(o)}})}openAddCouponForm(e,o={}){this.addCouponDialogRef=this.dialog.open(yt,{minWidth:"520px",width:"585px",disableClose:!0,data:{isViewOnly:e,...o}}),this.addCouponDialogRef.afterClosed().subscribe({next:a=>{a&&this.router.navigate(["/dashboard/payment/promo-codes/list/"+(a?.coupon?.type||"paid")],{skipLocationChange:!0})}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f.a),t.Y36(v.uw),t.Y36(C.r),t.Y36(x.c),t.Y36(h.gz),t.Y36(h.F0),t.Y36(m.Ye))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-coupon"]],decls:13,vars:2,consts:[[1,"title-group"],[1,"title"],[1,"mat-h1"],[1,"flex","space-between","mb-15"],[1,"title-buttons","ml-auto"],["mat-raised-button","","color","primary",3,"click"],["fxFlex","1 0"],["class","no-data  flex-center",4,"ngIf"],[4,"ngIf"],[1,"no-data","flex-center"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","coursename"],["matColumnDef","value"],["matColumnDef","usageLimit"],["matColumnDef","usageCounter"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"cursor-pointer",3,"matMenuTriggerFor"],["width","40","height","40","viewBox","0 0 40 40","fill","none","xmlns","http://www.w3.org/2000/svg"],["x","39.5","y","0.5","width","39","height","39","rx","19.5","transform","rotate(90 39.5 0.5)","fill","white","stroke","#F3F3F3"],["fill-rule","evenodd","clip-rule","evenodd","d","M20 10C21.1046 10 22 10.8954 22 12C22 13.1046 21.1046 14 20 14C18.8954 14 18 13.1046 18 12C18 10.8954 18.8954 10 20 10ZM20 18C21.1046 18 22 18.8954 22 20C22 21.1046 21.1046 22 20 22C18.8954 22 18 21.1046 18 20C18 18.8954 18.8954 18 20 18ZM22 28C22 26.8954 21.1046 26 20 26C18.8954 26 18 26.8954 18 28C18 29.1046 18.8954 30 20 30C21.1046 30 22 29.1046 22 28Z","fill","#BFBFBF"],["menu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3," Promo codes "),t.qZA()()(),t.TgZ(4,"div",3)(5,"div",4)(6,"button",5),t.NdJ("click",function(){return o.openAddCouponForm(!1)}),t.TgZ(7,"mat-icon"),t._uU(8,"add"),t.qZA(),t._uU(9," Add New "),t.qZA()()(),t._UZ(10,"mat-divider",6),t.YNc(11,bt,2,0,"p",7),t.YNc(12,jt,28,3,"div",8)),2&e&&(t.xp6(11),t.Q6J("ngIf",!o.apiCallActive&&(null==o.dataSource||null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)<=0),t.xp6(1),t.Q6J("ngIf",!o.apiCallActive&&(null==o.dataSource||null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)>0))},dependencies:[m.O5,A.lW,F.d,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,Zt.Hw,y.VK,y.OP,y.p6,m.gd,m.rS],styles:[".mat-tab-nav-bar[_ngcontent-%COMP%]{border:0}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-ink-bar[_ngcontent-%COMP%]{display:none}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-tab-links[_ngcontent-%COMP%]   .mat-tab-link[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#8f8f8f;padding:8px 16px;width:-moz-fit-content;width:fit-content;min-width:-moz-fit-content;min-width:fit-content;margin-right:8px}.mat-tab-nav-bar[_ngcontent-%COMP%]   .mat-tab-links[_ngcontent-%COMP%]   .mat-tab-link.mat-tab-label-active[_ngcontent-%COMP%]{background:#FFFFFF;box-shadow:0 2px 3px #0000000d;border-radius:8px;color:#1d1d1d}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;padding:8px}.flex-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:50%}.flex-row[_ngcontent-%COMP%]   .title-buttons[_ngcontent-%COMP%]{margin-left:auto}table[_ngcontent-%COMP%]{box-shadow:none;border-top:0}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-radius:8px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{margin-bottom:10px;font-size:13px;font-weight:700;line-height:22px;color:#3f3f3f;background-color:#f9f9f9}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;word-break:break-all}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#fff!important;font-size:12px;font-weight:600;color:#8f8f8f;border-top:0}table[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{line-height:13px;font-size:16px}tr.mat-row[_ngcontent-%COMP%]{border:white solid 4px;border-radius:8px}"]}),n})();var Et=r(2102),Bt=r(9839);const Rt=[{path:"promo-codes",component:$t},{path:"transaction-history",component:G},{path:"**",redirectTo:"promo-codes"}];let Gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,h.Bz.forChild(Rt),Et.q,Bt.D]}),n})()}}]);