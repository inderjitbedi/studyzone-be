"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[591],{591:(li,J,a)=>{a.r(J),a.d(J,{CourseModule:()=>ni});var u=a(6895),s=a(7155),p=a(9938),F=a(9302),c=a(4006),f=a(7368),D=a(8372),L=a(4004),k=a(7071),g=a(529),w=a(2340),e=a(4650),x=a(8606),C=a(3263),Y=a(2510),b=a(5412),_=a(9549),q=a(4144),Z=a(4859),T=a(4850),E=a(3683),S=a(7392),P=a(266),Q=a(6709),R=a(4385),O=a(3238);function H(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function z(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Course name already exists. "),e.qZA())}function B(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Course name can only be alpha-numeric. "),e.qZA())}function V(o,n){if(1&o&&(e.TgZ(0,"mat-hint",28),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE("",t.nameMaxLength-t.courseForm.controls.name.value.length," ",t.nameMaxLength-t.courseForm.controls.name.value.length>1?"characters":"character"," left.")}}function G(o,n){if(1&o&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.name," ")}}function $(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function K(o,n){1&o&&(e.TgZ(0,"div",30),e._UZ(1,"i",31)(2,"div"),e.TgZ(3,"div",32),e._uU(4,"Please select an image. Max size: 4MB"),e.qZA(),e.TgZ(5,"span",33),e._uU(6,"Select a file"),e.qZA()())}function W(o,n){if(1&o&&(e.TgZ(0,"div",34)(1,"div",35),e._uU(2),e.qZA(),e._UZ(3,"progress",36),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij("Uploading... ",t.uploadingProgress?t.uploadingProgress-1+"%":"0%",""),e.xp6(1),e.s9C("value",t.uploadingProgress)}}function X(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"img",37),e.NdJ("change",function(l){e.CHM(t);const r=e.oxw();return e.KtG(r.uploadFiles(l))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("src",t.courseForm.controls.cover.value?t.baseUrl+t.courseForm.controls.cover.value:"",e.LSH)}}function ee(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function te(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Choose a certain type of file. "),e.qZA())}function ie(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," File size should not be greater than 4MB. "),e.qZA())}function oe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-toolbar",38)(1,"div",39)(2,"button",40),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.saveCourse())}),e._uU(3,"Save"),e.qZA(),e.TgZ(4,"button",41),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.matDialog.close())}),e._uU(5,"Cancel"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",t.courseForm.invalid||t.apiCallActive)}}let ne=(()=>{class o{constructor(t,i,l,r,d,m,h,y){this.matDialog=t,this.data=i,this.apiService=l,this.errorHandlingService=r,this.matcher=d,this.fb=m,this.alertService=h,this.http=y,this.baseUrl=w.N.baseUrl,this.toggle=!1,this.apiCallActive=!1,this.nameMaxLength=50,this.courseList=[],this.color="#039ee3",this.isUnique=!0,this.fileObject={},this.uploadingInProgess=!1,this.attachment=null,this.types=[{value:"public",name:"Public"},{value:"private",name:"Private"},{value:"paid",name:"Paid"}],this.isViewOnly=i.isViewOnly,this.courseForm=this.fb.group({name:[i.name||"",[c.kI.required,c.kI.pattern("^[a-zA-Z0-9 s]*$")]],type:[i.type||"public",c.kI.required],description:[i.description||"",c.kI.required],isPublished:[i.isPublished],cover:["",c.kI.required]}),i._id&&(this.courseId=i._id||null,this.attachment=i.cover?{...i.cover}:{},this.courseForm.controls.cover.setValue([this.attachment.destination,this.attachment.name].join("/")),console.log(this.courseForm.controls.cover.value)),this.courseForm.controls.name.valueChanges.pipe((0,D.b)(500)).subscribe({next:N=>{this.checkCourseCategoryUniqueness()}})}checkCourseCategoryUniqueness(){}ngOnInit(){}saveCourse(){if(this.courseForm.valid){this.apiCallActive=!0;let t={type:this.courseForm.value.type,name:this.courseForm.value.name.trim().toLowerCase(),description:this.courseForm.value.description,isPublished:this.courseForm.value.isPublished,cover:this.attachment._id},i=p.d.createCourse,l=this.apiService.post(i,t);this.courseId&&(i+="/"+this.courseId,l=this.apiService.put(i,t)),l.subscribe({next:r=>{this.alertService.notify(r.message),this.matDialog.close(r)},error:r=>{this.errorHandlingService.handle(r)},complete:()=>{this.apiCallActive=!1}})}}uploadFiles(t){if(t.target.value){const i=t.target.files[0];this.fileObject.fileName=i.name,this.fileObject.fileExtension=i.name.split(".")[i.name.split(".").length-1].toLowerCase(),this.fileObject.fileSize=i.size;const l=k.g.allowedImageFileExtentions;if(l.find(r=>r===this.fileObject.fileExtension))if(this.fileObject.fileSize>k.g.maximumFileSize)this.alertService.notify(`Please make sure your file is less than ${k.g.maximumFileSize/1e6} MB in size.`);else{const r=new FormData;r.append("file",i),this.uploadFile(r)}else this.alertService.notify("Please make sure your file is in one of these formats: "+l)}}uploadFile(t){this.uploadingInProgess=!0,this.apiCallActive=!0,this.attachment=null,this.http.post(w.N.baseUrl+p.d.uploadFile+"cover",t,{reportProgress:!0,observe:"events"}).pipe((0,L.U)(i=>{switch(i.type){case g.dt.Sent:break;case g.dt.ResponseHeader:this.uploadingInProgess=!1,this.apiCallActive=!1;break;case g.dt.UploadProgress:this.uploadingProgress=Math.round(i.loaded/i.total*100);break;case g.dt.Response:this.apiCallActive=!1,201===i.status||201===i.status?(this.attachment={...i.body.file},this.courseForm.controls.cover.setValue([this.attachment.destination,this.attachment.name].join("/"))):this.errorHandlingService.handle(i.body),setTimeout(()=>{this.uploadingProgress=0},500)}})).subscribe()}formatBytes(t,i=2){if(0===t)return"0 Bytes";const r=i<=0?0:i||2,m=Math.floor(Math.log(t)/Math.log(1024));return"("+parseFloat((t/Math.pow(1024,m)).toFixed(r))+" "+["Bytes","KB","MB"][m]+")"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.so),e.Y36(f.WI),e.Y36(x.a),e.Y36(C.r),e.Y36(Y.d),e.Y36(c.qu),e.Y36(b.c),e.Y36(g.eN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-course-form"]],decls:52,vars:28,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],["aria-label","Close dialog","mat-button","",1,"mat-icon-button","mat-button",3,"click"],[1,"mat-button-wrapper"],["role","img","aria-hidden","true",1,"mat-icon","material-icons"],[1,"mt-10"],["fxLayout","column",1,"content","p-20","mt-20"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","100"],["type","text","matInput","","formControlName","name","trim","","autocomplete","off","maxlength","50",3,"errorStateMatcher","readonly"],[4,"ngIf"],["align","end",4,"ngIf"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["matInput","","rows","8","formControlName","description","trim","","autocomplete","off",3,"errorStateMatcher","readonly"],["fxLayout","column","fxLayout.gt-xs","row",1,"uploadImage","mt-20"],["matTooltip","Please select an image. Max size: 4MB","role","img","aria-hidden","true",1,"mat-icon","material-icons","info",3,"matTooltipPosition"],["id","file-upload-form",1,"uploader"],["id","file-upload","type","file","name","fileUpload","accept","image/png,image/jpeg,image/jpg",3,"change"],["for","file-upload","id","file-drag"],["id","start",4,"ngIf"],["id","response",4,"ngIf"],["id","file-image","alt","Preview",3,"src","change",4,"ngIf"],["formControlName","isPublished"],["class","mat-accent-bg m-0 mt-12","fxLayoutAlign","center",4,"ngIf"],["align","end"],[3,"value"],["id","start"],["aria-hidden","true",1,"fa","fa-download"],["id","notimage"],["id","file-upload-btn",1,"btn","btn-primary"],["id","response"],["id","messages"],["max","100",1,"progress",3,"value"],["id","file-image","alt","Preview",3,"src","change"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0","mt-12"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","button","mat-raised-button","",1,"mr-20",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.matDialog.close()}),e.TgZ(6,"span",5)(7,"mat-icon",6),e._uU(8,"close"),e.qZA()()()()(),e._UZ(9,"mat-divider",7),e.TgZ(10,"div",8)(11,"form",9)(12,"div",10)(13,"div",10)(14,"mat-form-field",11)(15,"mat-label"),e._uU(16,"Course Name "),e.qZA(),e._UZ(17,"input",12),e.YNc(18,H,2,0,"mat-error",13),e.YNc(19,z,2,0,"mat-error",13),e.YNc(20,B,2,0,"mat-error",13),e.YNc(21,V,2,2,"mat-hint",14),e.qZA()(),e.TgZ(22,"div",10)(23,"mat-form-field")(24,"mat-label"),e._uU(25,"Type"),e.qZA(),e.TgZ(26,"mat-select",15),e.YNc(27,G,2,2,"mat-option",16),e.qZA()()(),e.TgZ(28,"div",10)(29,"mat-form-field",11)(30,"mat-label"),e._uU(31,"Course Description "),e.qZA(),e._UZ(32,"textarea",17),e.YNc(33,$,2,0,"mat-error",13),e.qZA()(),e.TgZ(34,"div",18)(35,"mat-label"),e._uU(36,"Cover Image * "),e.TgZ(37,"mat-icon",19),e._uU(38," info "),e.qZA()(),e.TgZ(39,"div",20)(40,"input",21),e.NdJ("change",function(r){return i.uploadFiles(r)}),e.qZA(),e.TgZ(41,"label",22),e.YNc(42,K,7,0,"div",23),e.YNc(43,W,4,2,"div",24),e.YNc(44,X,1,1,"img",25),e.qZA()(),e.YNc(45,ee,2,0,"mat-error",13),e.YNc(46,te,2,0,"mat-error",13),e.YNc(47,ie,2,0,"mat-error",13),e.qZA(),e.TgZ(48,"div",10)(49,"mat-checkbox",26),e._uU(50," Publish now "),e.qZA()()()()(),e.YNc(51,oe,6,1,"mat-toolbar",27),e.qZA()),2&t&&(e.xp6(4),e.hij("",i.courseId?"Edit":"Create"," Course"),e.xp6(7),e.Q6J("formGroup",i.courseForm),e.xp6(1),e.ekj("form-div",!i.isViewOnly)("mt-30",i.isViewOnly),e.xp6(2),e.ekj("mb-10",i.courseForm.controls.name.touched&&i.courseForm.controls.name.hasError("required")),e.xp6(3),e.Q6J("errorStateMatcher",i.matcher)("readonly",i.isViewOnly),e.xp6(1),e.Q6J("ngIf",i.courseForm.controls.name.hasError("required")),e.xp6(1),e.Q6J("ngIf",!i.courseForm.controls.name.hasError("required")&&!i.courseForm.controls.name.hasError("pattern")&&i.courseForm.controls.name.hasError("not_unique")),e.xp6(1),e.Q6J("ngIf",!i.courseForm.controls.name.hasError("required")&&i.courseForm.controls.name.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",!i.isViewOnly),e.xp6(6),e.Q6J("ngForOf",i.types),e.xp6(2),e.ekj("mb-10",i.courseForm.controls.description.touched&&i.courseForm.controls.description.hasError("required")),e.xp6(3),e.Q6J("errorStateMatcher",i.matcher)("readonly",i.isViewOnly),e.xp6(1),e.Q6J("ngIf",i.courseForm.controls.description.hasError("required")),e.xp6(4),e.Q6J("matTooltipPosition","after"),e.xp6(5),e.Q6J("ngIf",!i.uploadingInProgess&&!i.attachment),e.xp6(1),e.Q6J("ngIf",i.uploadingInProgess),e.xp6(1),e.Q6J("ngIf",!i.uploadingInProgess&&i.attachment),e.xp6(1),e.Q6J("ngIf",null==i.courseForm.controls.cover?null:i.courseForm.controls.cover.hasError("required")),e.xp6(1),e.Q6J("ngIf",!(null!=i.courseForm.controls.cover&&i.courseForm.controls.cover.hasError("required"))&&i.courseForm.controls.cover.hasError("file_type")),e.xp6(1),e.Q6J("ngIf",!i.courseForm.controls.cover.hasError("required")&&!i.courseForm.controls.cover.hasError("file_type")&&i.courseForm.controls.cover.hasError("file_size")),e.xp6(4),e.Q6J("ngIf",!i.isViewOnly))},dependencies:[u.sg,u.O5,_.TO,_.KE,_.bx,_.hX,q.Nt,Z.lW,T.d,E.Ye,S.Hw,c._Y,c.Fj,c.JJ,c.JL,c.nD,c.sg,c.u,P.gM,Q.oG,R.gD,O.ey]}),o})();var v=a(9299),U=a(3848);function le(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"a",10),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.updateUrl(r))}),e._uU(1),e.qZA()}if(2&o){const t=n.$implicit,i=e.oxw();e.Q6J("active",i.currentUrl.indexOf(t.link)>-1),e.xp6(1),e.hij("",t.label," ")}}function re(o,n){1&o&&(e.TgZ(0,"p",11),e._uU(1," There is no course created yet!\n"),e.qZA())}function ae(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1,"#"),e.qZA())}function se(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&o){const t=n.index;e.xp6(1),e.hij(" ",t+1," ")}}function ce(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Name "),e.qZA())}function de(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.name)," ")}}function me(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Type "),e.qZA())}function ue(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.type)," ")}}function pe(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Status "),e.qZA())}function _e(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",24)(1,"mat-checkbox",25),e.NdJ("click",function(l){const r=e.CHM(t),d=r.index,m=r.$implicit,h=e.oxw(2);return l.preventDefault(),e.KtG(h.manageCourseVisibility(d,m))}),e._uU(2," Published "),e.qZA()()}if(2&o){const t=n.$implicit;e.xp6(1),e.Q6J("checked",t.isPublished)}}function fe(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Actions "),e.qZA())}const ge=function(o){return["/dashboard/course/details/",o]};function he(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",24)(1,"button",26),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.openAddCourseForm(!1,r))}),e.TgZ(2,"mat-icon"),e._uU(3,"edit"),e.qZA()(),e.TgZ(4,"button",27)(5,"mat-icon"),e._uU(6,"visibility"),e.qZA()(),e.TgZ(7,"button",28),e.NdJ("click",function(){const l=e.CHM(t),r=l.index,d=l.$implicit,m=e.oxw(2);return e.KtG(m.delete(r,d))}),e.TgZ(8,"mat-icon"),e._uU(9,"delete_outline"),e.qZA()()()}if(2&o){const t=n.$implicit;e.xp6(4),e.Q6J("routerLink",e.VKq(1,ge,t._id))}}function ve(o,n){1&o&&e._UZ(0,"tr",29)}function xe(o,n){1&o&&e._UZ(0,"tr",30)}function Ce(o,n){if(1&o&&(e.TgZ(0,"div",12)(1,"table",13),e.ynx(2,14),e.YNc(3,ae,2,0,"th",15),e.YNc(4,se,2,1,"td",16),e.BQk(),e.ynx(5,17),e.YNc(6,ce,2,0,"th",15),e.YNc(7,de,3,3,"td",16),e.BQk(),e.ynx(8,18),e.YNc(9,me,2,0,"th",15),e.YNc(10,ue,3,3,"td",16),e.BQk(),e.ynx(11,19),e.YNc(12,pe,2,0,"th",15),e.YNc(13,_e,3,1,"td",16),e.BQk(),e.ynx(14,20),e.YNc(15,fe,2,0,"th",15),e.YNc(16,he,10,3,"td",16),e.BQk(),e.YNc(17,ve,1,0,"tr",21),e.YNc(18,xe,1,0,"tr",22),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let be=(()=>{class o{constructor(t,i,l,r,d,m,h){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r,this.activeRoute=d,this.router=m,this._location=h,this.apiCallActive=!0,this.currentUrl="",this.activeLinkIndex=-1,this.displayedColumns=["id","name","type","isPublished","action"],this.activeRoute.params.subscribe({next:({type:y})=>{this.currentUrl=this.router.url,this.getCourses(y)}}),this.navLinks=[{label:"Public",link:"/dashboard/course/list/public",index:0},{label:"Private",link:"/dashboard/course/list/private",index:1},{label:"Paid",link:"/dashboard/course/list/paid",index:2}]}updateUrl(t){this._location.go(t.link),this.currentUrl=t.link,this.getCourses(t.label.toLowerCase())}ngOnInit(){this.router.routeReuseStrategy.shouldReuseRoute=()=>!1}delete(t,i){this.openConfirmDialog(t,i,{course:i,heading:"Delete course",type:"delete",message:"Are you sure you want to delete this course?"})}manageCourseVisibility(t,i){this.openConfirmDialog(t,i,{course:i,type:"visibility",heading:(i.isPublished?"Unpublish":"Publish")+" Course",message:"Are you sure you want to "+(i.isPublished?"un":"")+"publish this course?"})}openConfirmDialog(t,i,l={}){this.addCourseDialogRef=this.dialog.open(F.$,{minWidth:"320px",width:"585px",disableClose:!0,data:l}),this.addCourseDialogRef.afterClosed().subscribe({next:r=>{r&&("delete"==l.type?this.deleteCourse(t,i):this.manageCourse(t,i))}})}openAddCourseForm(t,i={}){this.addCourseDialogRef=this.dialog.open(ne,{minWidth:"320px",width:"585px",disableClose:!0,data:{isViewOnly:t,...i}}),this.addCourseDialogRef.afterClosed().subscribe({next:l=>{l&&this.router.navigate(["/dashboard/course/list/"+(l?.course?.type||"public")],{skipLocationChange:!0})}})}getCourses(t="public"){this.apiCallActive=!0,this.apiService.get(p.d.course+t).subscribe({next:i=>{this.apiCallActive=!1,this.dataSource=new s.by(i.courses||[])},error:i=>{this.apiCallActive=!1,this.errorHandlingService.handle(i)}})}manageCourse(t,i){this.apiService.put(p.d.manageCourseAccess+i._id,{isPublished:!i.isPublished}).subscribe({next:l=>{this.dataSource.data[t].isPublished=l.course.isPublished,this.alertService.notify(l.message)},error:l=>this.errorHandlingService.handle(l)})}deleteCourse(t,i){this.apiService.put(p.d.deleteCourse.replace(":id",i._id),{isDeleted:!0}).subscribe({next:l=>{this.dataSource.data.splice(t,1),this.dataSource=new s.by(this.dataSource.data||[]),this.alertService.notify(l.message)},error:l=>this.errorHandlingService.handle(l)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c),e.Y36(v.gz),e.Y36(v.F0),e.Y36(u.Ye))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-course-list"]],decls:12,vars:3,consts:[[1,"title-group"],[1,"title"],[1,"mat-h1"],[1,"title-buttons"],["mat-raised-button","","color","primary",3,"click"],["fxFlex","1 0"],["mat-tab-nav-bar",""],["mat-tab-link","",3,"active","click",4,"ngFor","ngForOf"],["class","no-data",4,"ngIf"],["class","container",4,"ngIf"],["mat-tab-link","",3,"active","click"],[1,"no-data"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","type"],["matColumnDef","isPublished"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"checked","click"],["mat-icon-button","","color","primary","aria-label","view",3,"click"],["mat-icon-button","","color","primary","aria-label","view",3,"routerLink"],["mat-icon-button","","color","warn","aria-label","delete",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),e._uU(3," Course List "),e.qZA()(),e.TgZ(4,"div",3)(5,"button",4),e.NdJ("click",function(){return i.openAddCourseForm(!1)}),e._uU(6," Add course "),e.qZA()()(),e._UZ(7,"mat-divider",5),e.TgZ(8,"nav",6),e.YNc(9,le,2,2,"a",7),e.qZA(),e.YNc(10,re,2,0,"p",8),e.YNc(11,Ce,19,3,"div",9)),2&t&&(e.xp6(9),e.Q6J("ngForOf",i.navLinks),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)<=0),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0))},dependencies:[v.rH,u.sg,u.O5,Z.lW,T.d,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,S.Hw,Q.oG,U.BU,U.Nj,u.rS],styles:["table td:first-child,table th:first-child{width:50px;word-break:break-all}table td:last-child,table th:last-child{width:100px;align-content:flex-end}table td:last-child .mat-icon-button,table th:last-child .mat-icon-button{width:25px}\n"],encapsulation:2}),o})();var I=a(3546),A=a(1206);function Ze(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function Te(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Slide name already exists. "),e.qZA())}function ye(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Slide name can only be alpha-numeric. "),e.qZA())}function Se(o,n){if(1&o&&(e.TgZ(0,"mat-hint",22),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE("",t.nameMaxLength-t.slideForm.controls.name.value.length," ",t.nameMaxLength-t.slideForm.controls.name.value.length>1?"characters":"character"," left.")}}function Fe(o,n){if(1&o&&(e.TgZ(0,"mat-option",23),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",e.lcZ(2,2,t)," ")}}function Ae(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e._UZ(2,"br"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" The allowed extensions are ",t.selectedFileSettings.extensions,".")}}function we(o,n){if(1&o&&(e.TgZ(0,"div",31),e._UZ(1,"i",32)(2,"div"),e.TgZ(3,"div",33),e._uU(4),e._UZ(5,"br"),e.YNc(6,Ae,3,1,"span",13),e._uU(7),e.qZA(),e.TgZ(8,"span",34),e._uU(9,"Select a file"),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(4),e.hij("Please select ",t.selectedFileSettings.name," file."),e.xp6(2),e.Q6J("ngIf","pdf"!=t.selectedType),e.xp6(1),e.hij(" Max size: ",t.selectedFileSettings.maxSize,"MB")}}function qe(o,n){1&o&&(e.TgZ(0,"div",31)(1,"span",34),e._uU(2,"Select another"),e.qZA()())}function Ue(o,n){if(1&o&&(e.TgZ(0,"div",35)(1,"div",36),e._uU(2),e.qZA(),e._UZ(3,"progress",37),e.qZA()),2&o){const t=e.oxw(2);e.xp6(2),e.hij("Uploading... ",t.uploadingProgress?t.uploadingProgress-1+"%":"0%",""),e.xp6(1),e.s9C("value",t.uploadingProgress)}}function Ie(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function Ne(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Choose a certain type of file. "),e.qZA())}function Me(o,n){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" File size should not be greater than ",t.selectedFileSettings.maxSize,"MB. ")}}function De(o,n){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,Ie,2,0,"mat-error",13),e.YNc(2,Ne,2,0,"mat-error",13),e.YNc(3,Me,2,1,"mat-error",13),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==t.slideForm.controls[t.selectedFileSettings.key]?null:t.slideForm.controls[t.selectedFileSettings.key].hasError("required")),e.xp6(1),e.Q6J("ngIf",!(null!=t.slideForm.controls[t.selectedFileSettings.key]&&t.slideForm.controls[t.selectedFileSettings.key].hasError("required"))&&(null==t.slideForm.controls[t.selectedFileSettings.key]?null:t.slideForm.controls[t.selectedFileSettings.key].hasError("file_type"))),e.xp6(1),e.Q6J("ngIf",!(null!=t.slideForm.controls[t.selectedFileSettings.key]&&t.slideForm.controls[t.selectedFileSettings.key].hasError("required"))&&!(null!=t.slideForm.controls[t.selectedFileSettings.key]&&t.slideForm.controls[t.selectedFileSettings.key].hasError("file_type"))&&(null==t.slideForm.controls[t.selectedFileSettings.key]?null:t.slideForm.controls[t.selectedFileSettings.key].hasError("file_size")))}}function ke(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",24)(1,"mat-label"),e._uU(2),e.ALo(3,"titlecase"),e.TgZ(4,"mat-icon",25),e._uU(5," info "),e.qZA()(),e.TgZ(6,"div",26)(7,"input",27),e.NdJ("change",function(l){e.CHM(t);const r=e.oxw();return e.KtG(r.uploadFiles(l))}),e.qZA(),e.TgZ(8,"label",28),e.YNc(9,we,10,3,"div",29),e.YNc(10,qe,3,0,"div",29),e.YNc(11,Ue,4,2,"div",30),e.qZA()(),e.YNc(12,De,4,3,"div",13),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.hij("",e.lcZ(3,9,t.selectedFileSettings.name)," * "),e.xp6(2),e.hYB("matTooltip","Please select an ",t.selectedFileSettings.name,". Max size: ",t.selectedFileSettings.maxSize,"MB"),e.Q6J("matTooltipPosition","after"),e.xp6(3),e.s9C("accept",t.selectedFileSettings.mimeTypes),e.xp6(2),e.Q6J("ngIf",!(t.uploadingInProgess||t.attachment||null!=t.slideForm.controls[t.selectedFileSettings.key]&&t.slideForm.controls[t.selectedFileSettings.key].value)),e.xp6(1),e.Q6J("ngIf",!t.uploadingInProgess&&(t.attachment||(null==t.slideForm.controls[t.selectedFileSettings.key]?null:t.slideForm.controls[t.selectedFileSettings.key].value))),e.xp6(1),e.Q6J("ngIf",t.uploadingInProgess),e.xp6(1),e.Q6J("ngIf",!(t.attachment||null!=t.slideForm.controls[t.selectedFileSettings.key]&&t.slideForm.controls[t.selectedFileSettings.key].value))}}function Ye(o,n){if(1&o&&(e.TgZ(0,"video",38),e._uU(1," Sorry, your browser doesn't support embedded videos. "),e.qZA()),2&o){const t=e.oxw();e.s9C("src",t.slideForm.controls.file.value?t.environment.baseUrl+t.slideForm.controls.file.value:"",e.LSH)}}function Ee(o,n){if(1&o&&(e.TgZ(0,"div",39)(1,"audio",40),e._UZ(2,"source",41),e._uU(3," Sorry, your browser does not support the audio element. "),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.s9C("src",t.slideForm.controls.file.value?t.environment.baseUrl+t.slideForm.controls.file.value:"",e.LSH)}}function Oe(o,n){1&o&&(e.TgZ(0,"span",43),e._uU(1,"picture_as_pdf"),e.qZA())}function Je(o,n){if(1&o&&(e.TgZ(0,"div",39)(1,"p"),e.YNc(2,Oe,2,0,"span",42),e._uU(3),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.attachment.originalName),e.xp6(1),e.hij(" ",t.attachment.originalName||"No file found","")}}function Le(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}function Pe(o,n){if(1&o&&(e.TgZ(0,"div",10)(1,"mat-form-field",44)(2,"mat-label"),e._uU(3,"Text "),e.qZA(),e._UZ(4,"textarea",45),e.YNc(5,Le,2,0,"mat-error",13),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("errorStateMatcher",t.matcher)("rows",t.isViewOnly?15:10)("readonly",t.isViewOnly),e.xp6(1),e.Q6J("ngIf",t.slideForm.controls.text.hasError("required"))}}function Qe(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"mat-toolbar",46)(1,"div",47)(2,"button",48),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.saveSlide())}),e._uU(3,"Save"),e.qZA(),e.TgZ(4,"button",49),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.matDialog.close())}),e._uU(5,"Cancel"),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("disabled",t.slideForm.invalid||t.apiCallActive)}}let Re=(()=>{class o{constructor(t,i,l,r,d,m,h,y,N){this.matDialog=t,this.data=i,this.apiService=l,this.errorHandlingService=r,this.matcher=d,this.fb=m,this.http=h,this.alertService=y,this.activeRoute=N,this.environment=w.N,this.toggle=!1,this.apiCallActive=!1,this.nameMaxLength=50,this.slideList=[],this.color="#039ee3",this.isUnique=!0,this.fileObject={},this.uploadingInProgess=!1,this.attachment=null,this.types=["text","video","audio","pdf"],this.selectedType=1,this.selectedFileSettings={},this.fileSettings=[{name:"video",maxSize:200,mimeTypes:"video/mp4,video/webm,video/ogg",extensions:["mp4","ogg","webm"],fileType:"MP4, WebM or OGG",key:"file"},{name:"audio",maxSize:200,mimeTypes:"audio/mpeg,audio/ogg,audio/wav",extensions:["mp3","ogg","wav"],fileType:"MP3, OGG or WAV"},{name:"pdf",maxSize:100,mimeTypes:"application/pdf",extensions:["pdf"],fileType:"PDF"}],this.isViewOnly=i.isViewOnly,this.slideForm=this.fb.group({name:[i.name||"",[c.kI.required,c.kI.pattern("^[a-zA-Z0-9 s]*$")]],type:[i.type||"text",c.kI.required],text:[i.text||""],file:[""]}),this.selectedSlideDetails=i,this.courseId=i.courseId,this.selectedType=i.type||"text",i._id&&(this.slideId=i._id||null,this.typeUpdated(i.type),i.file&&(this.attachment=i.file?{...i.file}:{},this.slideForm.controls.file.setValue([this.attachment.destination,this.attachment.name].join("/")))),this.slideForm.controls.name.valueChanges.pipe((0,D.b)(500)).subscribe({next:M=>{this.checkSlideUniqueness()}}),this.slideForm.controls.type.valueChanges.subscribe({next:M=>{this.typeUpdated(M)}})}checkSlideUniqueness(){}ngOnInit(){}saveSlide(){if(this.slideForm.valid){this.apiCallActive=!0;let t={type:this.slideForm.value.type,name:this.slideForm.value.name.trim().toLowerCase(),position:this.selectedSlideDetails.position||this.selectedSlideDetails.totalSlides+1};"text"==t.type?t.text=this.slideForm.value.text:t.file=this.attachment._id;let i=p.d.createSlide.replace(":id",this.courseId),l=this.apiService.post(i,t);this.slideId&&(i+="/"+this.slideId,l=this.apiService.put(i,t)),l.subscribe({next:r=>{this.alertService.notify(r.message),this.matDialog.close(r)},error:r=>{this.errorHandlingService.handle(r)},complete:()=>{this.apiCallActive=!1}})}}clearOthers(t){this.selectedSlideDetails[t]&&(this.slideForm.controls[t].setValue(this.selectedSlideDetails[t]),this.slideForm.controls[t].updateValueAndValidity()),"text"!=t?(this.fileObject={},this.uploadingInProgess=!1,this.uploadingProgress=0,this.attachment=null,this.slideForm.controls.file.setValue(""),this.slideForm.controls.file.setValidators([]),this.slideForm.controls.file.updateValueAndValidity()):(this.slideForm.controls.text.setValue(""),this.slideForm.controls.text.setValidators([]),this.slideForm.controls.text.updateValueAndValidity())}setValidators(t,i){this.slideForm.controls[t].setValidators(i),this.slideForm.controls[t].updateValueAndValidity(),this.clearOthers(t)}typeUpdated(t){"text"===(this.selectedType=t,t)?(this.selectedFileSettings={},this.setValidators(t,[c.kI.required])):(this.selectedFileSettings=this.fileSettings.filter(i=>i.name===t),this.selectedFileSettings=this.selectedFileSettings[0],this.setValidators("file",[c.kI.required]))}uploadFiles(t){if(t.target.value){const i=t.target.files[0];this.fileObject.fileName=i.name,this.fileObject.fileExtension=i.name.split(".")[i.name.split(".").length-1].toLowerCase(),this.fileObject.fileSize=i.size;const l=this.selectedFileSettings.extensions;if(l.find(r=>r===this.fileObject.fileExtension))if(this.fileObject.fileSize>1e6*this.selectedFileSettings.maxSize)this.alertService.notify(`Please make sure your file is less than ${this.selectedFileSettings.maxSize} MB in size.`);else{const r=new FormData;r.append("file",i),this.uploadFile(r)}else this.alertService.notify("Please make sure your file is in one of these formats: "+l)}}uploadFile(t){this.uploadingInProgess=!0,this.apiCallActive=!0,this.attachment=null,this.http.post(w.N.baseUrl+p.d.uploadFile+this.selectedFileSettings.name,t,{reportProgress:!0,observe:"events"}).pipe((0,L.U)(i=>{switch(i.type){case g.dt.Sent:break;case g.dt.ResponseHeader:this.uploadingInProgess=!1,this.apiCallActive=!1;break;case g.dt.UploadProgress:this.uploadingProgress=Math.round(i.loaded/i.total*100);break;case g.dt.Response:this.apiCallActive=!1;const l=i.body.file;console.log(l),this.attachment={...l},this.slideForm.controls.file.setValue([this.attachment.destination,this.attachment.name].join("/")),setTimeout(()=>{this.uploadingProgress=0},500)}})).subscribe()}formatBytes(t,i=2){if(0===t)return"0 Bytes";const r=i<=0?0:i||2,m=Math.floor(Math.log(t)/Math.log(1024));return"("+parseFloat((t/Math.pow(1024,m)).toFixed(r))+" "+["Bytes","KB","MB"][m]+")"}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.so),e.Y36(f.WI),e.Y36(x.a),e.Y36(C.r),e.Y36(Y.d),e.Y36(c.qu),e.Y36(g.eN),e.Y36(b.c),e.Y36(v.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-slide-form"]],decls:34,vars:21,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],["aria-label","Close dialog","mat-button","",1,"mat-icon-button","mat-button",3,"click"],[1,"mat-button-wrapper"],["role","img","aria-hidden","true",1,"mat-icon","material-icons"],[1,"mt-10"],["fxLayout","column",1,"content","p-20","mt-20"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],["fxFlex","100"],["type","text","matInput","","formControlName","name","trim","","autocomplete","off","maxlength","50",3,"errorStateMatcher","readonly"],[4,"ngIf"],["align","end",4,"ngIf"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","column","fxLayout.gt-xs","row","class","uploadImage",4,"ngIf"],["controls","","width","100%",3,"src",4,"ngIf"],["style","text-align: center;width: 100%;",4,"ngIf"],["fxLayout","column","fxLayout.gt-xs","row",4,"ngIf"],["class","mat-accent-bg m-0 mt-12","fxLayoutAlign","center",4,"ngIf"],["align","end"],[3,"value"],["fxLayout","column","fxLayout.gt-xs","row",1,"uploadImage"],["role","img","aria-hidden","true",1,"mat-icon","material-icons","info",3,"matTooltip","matTooltipPosition"],["id","file-upload-form",1,"uploader"],["id","file-upload","type","file","name","fileUpload",3,"accept","change"],["for","file-upload","id","file-drag"],["id","start",4,"ngIf"],["id","response",4,"ngIf"],["id","start"],["aria-hidden","true",1,"fa","fa-download"],["id","notimage"],["id","file-upload-btn",1,"btn","btn-primary"],["id","response"],["id","messages"],["max","100",1,"progress",3,"value"],["controls","","width","100%",3,"src"],[2,"text-align","center","width","100%"],["controls",""],[3,"src"],["class","material-icons",4,"ngIf"],[1,"material-icons"],["fxFlex","100",1,"mb-10"],["matInput","","formControlName","text","trim","","autocomplete","off",3,"errorStateMatcher","rows","readonly"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0","mt-12"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","button","mat-raised-button","",1,"mr-20",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),e._uU(4),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.matDialog.close()}),e.TgZ(6,"span",5)(7,"mat-icon",6),e._uU(8,"close"),e.qZA()()()()(),e._UZ(9,"mat-divider",7),e.TgZ(10,"div",8)(11,"form",9)(12,"div",10)(13,"div",10)(14,"mat-form-field",11)(15,"mat-label"),e._uU(16,"Slide Name "),e.qZA(),e._UZ(17,"input",12),e.YNc(18,Ze,2,0,"mat-error",13),e.YNc(19,Te,2,0,"mat-error",13),e.YNc(20,ye,2,0,"mat-error",13),e.YNc(21,Se,2,2,"mat-hint",14),e.qZA()(),e.TgZ(22,"div",10)(23,"mat-form-field")(24,"mat-label"),e._uU(25,"Type"),e.qZA(),e.TgZ(26,"mat-select",15),e.YNc(27,Fe,3,4,"mat-option",16),e.qZA()()(),e.YNc(28,ke,13,11,"div",17),e.YNc(29,Ye,2,1,"video",18),e.YNc(30,Ee,4,1,"div",19),e.YNc(31,Je,4,2,"div",19),e.YNc(32,Pe,6,4,"div",20),e.qZA()()(),e.YNc(33,Qe,6,1,"mat-toolbar",21),e.qZA()),2&t&&(e.xp6(4),e.hij("",i.slideId?"Edit":"Create"," Slide"),e.xp6(7),e.Q6J("formGroup",i.slideForm),e.xp6(1),e.ekj("form-div",!i.isViewOnly)("mt-30",i.isViewOnly),e.xp6(2),e.ekj("mb-10",i.slideForm.controls.name.touched&&i.slideForm.controls.name.hasError("required")),e.xp6(3),e.Q6J("errorStateMatcher",i.matcher)("readonly",i.isViewOnly),e.xp6(1),e.Q6J("ngIf",i.slideForm.controls.name.hasError("required")),e.xp6(1),e.Q6J("ngIf",!i.slideForm.controls.name.hasError("required")&&!i.slideForm.controls.name.hasError("pattern")&&i.slideForm.controls.name.hasError("not_unique")),e.xp6(1),e.Q6J("ngIf",!i.slideForm.controls.name.hasError("required")&&i.slideForm.controls.name.hasError("pattern")),e.xp6(1),e.Q6J("ngIf",!i.isViewOnly),e.xp6(6),e.Q6J("ngForOf",i.types),e.xp6(1),e.Q6J("ngIf",("video"==i.selectedType||"audio"==i.selectedType||"pdf"==i.selectedType)&&!i.isViewOnly),e.xp6(1),e.Q6J("ngIf",!i.uploadingInProgess&&(i.attachment||(null==i.slideForm.controls[i.selectedFileSettings.key]?null:i.slideForm.controls[i.selectedFileSettings.key].value))&&"video"==i.selectedType||i.isViewOnly&&"video"==i.selectedSlideDetails.type),e.xp6(1),e.Q6J("ngIf",!i.uploadingInProgess&&(i.attachment||(null==i.slideForm.controls[i.selectedFileSettings.key]?null:i.slideForm.controls[i.selectedFileSettings.key].value))&&"audio"==i.selectedType||i.isViewOnly&&"audio"==i.selectedSlideDetails.type),e.xp6(1),e.Q6J("ngIf",!i.uploadingInProgess&&(i.attachment||(null==i.slideForm.controls[i.selectedFileSettings.key]?null:i.slideForm.controls[i.selectedFileSettings.key].value))&&"pdf"==i.selectedType||i.isViewOnly&&"pdf"==i.selectedSlideDetails.type),e.xp6(1),e.Q6J("ngIf","text"==i.selectedType||i.isViewOnly&&"text"==i.selectedSlideDetails.type),e.xp6(1),e.Q6J("ngIf",!i.isViewOnly))},dependencies:[u.sg,u.O5,_.TO,_.KE,_.bx,_.hX,q.Nt,Z.lW,T.d,E.Ye,S.Hw,c._Y,c.Fj,c.JJ,c.JL,c.nD,c.sg,c.u,P.gM,R.gD,O.ey,u.rS]}),o})();function je(o,n){1&o&&(e.TgZ(0,"div",5),e._uU(1,"No slides found"),e.qZA())}function He(o,n){1&o&&(e.TgZ(0,"div",16)(1,"i",17),e._uU(2,"drag_indicator"),e.qZA()())}function ze(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",18)(1,"i",19),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().index,r=e.oxw(2);return e.KtG(r.delete(l))}),e._uU(2,"delete_outline"),e.qZA()()}}function Be(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",18)(1,"i",19),e.NdJ("click",function(){e.CHM(t);const l=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.openAddSlideForm(!1,l))}),e._uU(2,"edit"),e.qZA()()}}function Ve(o,n){if(1&o&&(e.TgZ(0,"div",10),e.YNc(1,He,3,0,"div",11),e.TgZ(2,"div",12),e._uU(3),e.qZA(),e.TgZ(4,"div",13),e._uU(5),e.ALo(6,"titlecase"),e.qZA(),e.TgZ(7,"div",14),e.YNc(8,ze,3,0,"button",15),e.YNc(9,Be,3,0,"button",15),e.qZA()()),2&o){const t=n.$implicit,i=n.index,l=e.oxw(2);e.xp6(1),e.Q6J("ngIf",l.reorderMode),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",e.lcZ(6,5,t.name)," "),e.xp6(3),e.Q6J("ngIf",!l.reorderMode),e.xp6(1),e.Q6J("ngIf",!l.reorderMode)}}function Ge(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const l=e.oxw(2);return e.KtG(l.reorderMode?l.saveOrder():l.reorderSlides())}),e._uU(1),e.TgZ(2,"i",4),e._uU(3),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.reorderMode?"Save":"Reorder"," "),e.xp6(2),e.Oqu(t.reorderMode?"add_circle_outline":"swap_vert")}}function $e(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const l=e.oxw(2);return e.KtG(l.cancelReorder())}),e._uU(1," Cancel"),e.TgZ(2,"i",4),e._uU(3,"cancel"),e.qZA()()}}function Ke(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",6)(1,"div",7),e.NdJ("cdkDropListDropped",function(l){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(l))}),e.YNc(2,Ve,10,7,"div",8),e.qZA(),e.TgZ(3,"div"),e.YNc(4,Ge,4,2,"button",9),e.YNc(5,$e,4,0,"button",9),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.slides),e.xp6(2),e.Q6J("ngIf",(null==t.slides?null:t.slides.length)>=2),e.xp6(1),e.Q6J("ngIf",t.reorderMode)}}let We=(()=>{class o{constructor(t,i,l,r,d,m){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r,this.activeRoute=d,this.router=m,this.apiCallActive=!1,this.rootComments=[],this.slides=[],this.orderedSlides=[],this.reorderMode=!1,this.activeRoute.params.subscribe({next:({id:h})=>{this.courseId=h,this.getSlides()}})}ngOnInit(){}getSlides(){let t=p.d.slide.replace(":id",this.courseId);this.apiCallActive=!0,this.apiService.get(t).subscribe({next:i=>{this.apiCallActive=!1,this.slides=i.slides||[],this.orderedSlides=[...this.slides]},error:i=>{this.apiCallActive=!1,this.errorHandlingService.handle(i)}})}openAddSlideForm(t,i={}){this.addSlideDialogRef=this.dialog.open(Re,{minWidth:"320px",width:"585px",disableClose:!0,data:{isViewOnly:t,...i,totalSlides:this.slides.length,courseId:this.courseId}}),this.addSlideDialogRef.afterClosed().subscribe({next:l=>{l&&(this.router.navigate(["/dashboard/course/details/"+this.courseId],{skipLocationChange:!0}),this.getSlides())}})}delete(t){this.confirmDialogRef=this.dialog.open(F.$,{minWidth:"320px",width:"585px",disableClose:!0,data:{slide:this.slides[t],heading:"Delete slide",message:"Are you sure you want to delete this slide?"}}),this.confirmDialogRef.afterClosed().subscribe({next:i=>{i&&this.deleteSlide(this.slides[t]._id)}})}deleteSlide(t){this.apiService.put(p.d.updateSlide.replace(":id",this.courseId).replace(":slideid",t),{isDeleted:!0}).subscribe({next:i=>{this.slides=this.slides.filter(l=>l._id!=t),this.alertService.notify("Slide deleted successfully")},error:i=>this.errorHandlingService.handle(i)})}reorderSlides(){this.reorderMode=!this.reorderMode}cancelReorder(){this.reorderMode=!1,this.slides=[...this.orderedSlides]}saveOrder(){let t=p.d.reorderSildes.replace(":id",this.courseId);this.apiCallActive=!0,this.apiService.put(t,{slides:this.slides.map(i=>i._id)}).subscribe({next:i=>{this.apiCallActive=!1,this.reorderMode=!1,this.orderedSlides=[...this.slides],this.alertService.notify(i.message)},error:i=>{this.apiCallActive=!1,this.errorHandlingService.handle(i)}})}drop(t){(0,A.bA)(this.slides,t.previousIndex,t.currentIndex)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c),e.Y36(v.gz),e.Y36(v.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["slide-list"]],decls:7,vars:2,consts:[[1,"slide-list-wrapper"],["class","no-data",4,"ngIf"],["class","reorder-wrapper",4,"ngIf"],["mat-raised-button","","color","primary",1,"m-4",3,"click"],[1,"material-icons"],[1,"no-data"],[1,"reorder-wrapper"],["cdkDropList","",1,"slide-list","mt-20",3,"cdkDropListDropped"],["class","slide-box","cdkDrag","",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","class","m-4",3,"click",4,"ngIf"],["cdkDrag","",1,"slide-box"],["class","w-10 drag-icon",4,"ngIf"],[1,"drag-index"],[1,"w-100","drag-content"],[1,"w-10","delete-icon"],["mat-icon-button","",4,"ngIf"],[1,"w-10","drag-icon"],["cdkDragHandle","",1,"material-icons"],["mat-icon-button",""],[1,"material-icons",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,je,2,0,"div",1),e.YNc(2,Ke,6,3,"div",2),e.TgZ(3,"button",3),e.NdJ("click",function(){return i.openAddSlideForm(!1)}),e._uU(4," Add New "),e.TgZ(5,"i",4),e._uU(6,"add_circle_outline"),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",!(null!=i.slides&&i.slides.length)),e.xp6(1),e.Q6J("ngIf",null==i.slides?null:i.slides.length))},dependencies:[u.sg,u.O5,Z.lW,A.Wj,A.Zt,A.Bh,u.rS],styles:[".slide-list-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}.reorder-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start}.slide-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:solid 1px #ccc;min-height:160px;display:block;justify-content:space-between;background:white;border-radius:4px;overflow:auto;max-height:calc(100vh - 400px);box-sizing:border-box}button[_ngcontent-%COMP%]{margin:20px 10px 0 0}.slide-box[_ngcontent-%COMP%]{padding:20px 10px;border:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;margin-bottom:10px;justify-content:space-between;box-sizing:border-box;background:white;font-size:14px}.slide-box[_ngcontent-%COMP%]   .drag-icon[_ngcontent-%COMP%]{cursor:move}.container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center}.drag-icon[_ngcontent-%COMP%]{position:relative}.drag-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:move}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.slide-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .slide-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]}),o})(),Xe=(()=>{class o{transform(t){const i=t.split(" ");return`${i[0].charAt(0).toUpperCase()}${i[i.length-1].charAt(0).toUpperCase()}`}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"initials",type:o,pure:!0}),o})();function et(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",13)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"initials"),e.qZA(),e.TgZ(5,"div",3)(6,"h5"),e._uU(7),e.ALo(8,"titlecase"),e.qZA(),e.TgZ(9,"span",4),e._uU(10),e.qZA(),e.TgZ(11,"div",7),e._uU(12),e.qZA()(),e.TgZ(13,"button",14),e.NdJ("click",function(){const r=e.CHM(t).$implicit,d=e.oxw();return e.KtG(d.delete(r))}),e.TgZ(14,"i",6),e._uU(15,"delete_outline"),e.qZA()()()()}if(2&o){const t=n.$implicit;e.xp6(3),e.hij(" ",e.lcZ(4,4,t.author.fullName)," "),e.xp6(4),e.Oqu(e.lcZ(8,6,t.author.fullName)),e.xp6(3),e.hij("- ",t.createdAt,""),e.xp6(2),e.hij(" ",t.text," ")}}let tt=(()=>{class o{constructor(t,i,l,r){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r}ngOnInit(){console.log(this.comment)}delete(t){this.confirmDialogRef=this.dialog.open(F.$,{minWidth:"320px",width:"585px",disableClose:!0,data:{heading:"Delete slide",message:"Are you sure you want to delete this comment?"}}),this.confirmDialogRef.afterClosed().subscribe({next:i=>{i&&this.deleteComment(t._id)}})}deleteComment(t){this.apiService.put(p.d.deleteComment.replace(":id",this.courseId).replace(":commentId",t),{isDeleted:!0}).subscribe({next:i=>{this.alertService.notify(i.message)},error:i=>this.errorHandlingService.handle(i)})}addComment(t){this.apiService.post(p.d.addComment.replace(":id",this.courseId),{text:"",parent:""}).subscribe({next:i=>{this.alertService.notify(i.message)},error:i=>this.errorHandlingService.handle(i)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["comment"]],inputs:{comment:"comment",courseId:"courseId"},decls:25,vars:10,consts:[[1,"comment"],[1,"user-banner"],[1,"avatar",2,"background-color","#fff5e9","border-color","#ffe0bd","color","#F98600"],[1,"user"],[1,"is-mute"],["mat-icon-button","",1,"ml-auto",3,"click"],[1,"material-icons"],[1,"content"],["class","reply-body comment",4,"ngFor","ngForOf"],[1,"footer","w-100"],["fxFlex","100",1,"w-100"],["matInput","","trim","",3,"rows"],["type","submit","mat-raised-button","","color","primary"],[1,"reply-body","comment"],["mat-icon-button","",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"initials"),e.qZA(),e.TgZ(5,"div",3)(6,"h5"),e._uU(7),e.ALo(8,"titlecase"),e.qZA(),e.TgZ(9,"span",4),e._uU(10),e.qZA(),e.TgZ(11,"button",5),e.NdJ("click",function(){return i.delete(i.comment)}),e.TgZ(12,"i",6),e._uU(13,"delete_outline"),e.qZA()(),e.TgZ(14,"div",7)(15,"div"),e._uU(16),e.qZA(),e.YNc(17,et,16,8,"div",8),e.qZA(),e.TgZ(18,"div",9)(19,"mat-form-field",10)(20,"mat-label"),e._uU(21,"Reply "),e.qZA(),e._UZ(22,"textarea",11),e.qZA(),e.TgZ(23,"button",12),e._uU(24,"Reply"),e.qZA()()()()()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,6,i.comment.author.fullName)," "),e.xp6(4),e.hij("",e.lcZ(8,8,i.comment.author.fullName)," "),e.xp6(3),e.hij("- ",i.comment.createdAt,""),e.xp6(6),e.hij(" ",i.comment.text,""),e.xp6(1),e.Q6J("ngForOf",i.comment.children),e.xp6(5),e.Q6J("rows",3))},dependencies:[u.sg,_.KE,_.hX,q.Nt,Z.lW,u.rS,Xe],styles:[".ml-auto[_ngcontent-%COMP%]{margin-left:auto}.w-100[_ngcontent-%COMP%]{width:100%}"]}),o})();var j=a(3805);function it(o,n){if(1&o&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.Q6J("value",t.email),e.xp6(1),e.hij(" ",t.email+(t.fullName||"")," ")}}function ot(o,n){if(1&o&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.enrollForm.controls.user.value?"No match found":"Type to search for users"," ")}}function nt(o,n){1&o&&(e.TgZ(0,"mat-error"),e._uU(1,"Required "),e.qZA())}let lt=(()=>{class o{constructor(t,i,l,r,d,m,h,y,N){this.matDialog=t,this.data=i,this.apiService=l,this.errorHandlingService=r,this.matcher=d,this.fb=m,this.http=h,this.alertService=y,this.activeRoute=N,this.apiCallActive=!1,this.filteredUsers=[],this.courseId=i.courseId,this.enrollForm=this.fb.group({user:["",c.kI.required]}),this.enrollForm.controls.user.valueChanges.pipe((0,D.b)(500)).subscribe({next:M=>{this.getUsersToEnroll(M)}})}displayFn(t){return t?t.email:""}getUsersToEnroll(t){let i=p.d.getUsersToEnroll.replace(":id",this.courseId);t?(i+="?search="+t.toLowerCase(),this.apiService.get(i).subscribe({next:l=>{this.filteredUsers=l.users},error:l=>{this.apiCallActive=!1,this.errorHandlingService.handle(l)}})):this.filteredUsers=[]}changed(t){console.log(t),this.selectedOption=t.value}ngOnInit(){}enrollUser(){this.enrollForm.valid&&this.selectedOption==this.enrollForm.value.user&&this.apiService.post(p.d.courseEnrollment.replace(":id",this.courseId),{user:this.enrollForm.value.user}).subscribe({next:t=>{this.alertService.notify(t.message),this.matDialog.close(t)},error:t=>this.errorHandlingService.handle(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f.so),e.Y36(f.WI),e.Y36(x.a),e.Y36(C.r),e.Y36(Y.d),e.Y36(c.qu),e.Y36(g.eN),e.Y36(b.c),e.Y36(v.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-new-enrollment"]],decls:28,vars:6,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],["aria-label","Close dialog","mat-button","",1,"mat-icon-button","mat-button",3,"click"],[1,"mat-button-wrapper"],["role","img","aria-hidden","true",1,"mat-icon","material-icons"],[1,"mt-10"],["fxLayout","column",1,"content","p-20","mt-20"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],["type","text","matInput","","formControlName","user",3,"matAutocomplete"],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["disabled","",4,"ngIf"],[4,"ngIf"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0","mt-12"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["type","submit","mat-raised-button","","color","primary",3,"disabled","click"],["type","button","mat-raised-button","",1,"mr-20",3,"click"],[3,"value"],["disabled",""]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),e._uU(4,"Enroll User"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return i.matDialog.close()}),e.TgZ(6,"span",5)(7,"mat-icon",6),e._uU(8,"close"),e.qZA()()()()(),e._UZ(9,"mat-divider",7),e.TgZ(10,"div",8)(11,"form",9)(12,"div",10)(13,"mat-form-field")(14,"mat-label"),e._uU(15,"User "),e.qZA(),e._UZ(16,"input",11),e.TgZ(17,"mat-autocomplete",12,13),e.NdJ("optionSelected",function(r){return i.changed(r.option)}),e.YNc(19,it,2,2,"mat-option",14),e.YNc(20,ot,2,1,"mat-option",15),e.qZA(),e.YNc(21,nt,2,0,"mat-error",16),e.qZA()()()(),e.TgZ(22,"mat-toolbar",17)(23,"div",18)(24,"button",19),e.NdJ("click",function(){return i.enrollUser()}),e._uU(25,"Enroll"),e.qZA(),e.TgZ(26,"button",20),e.NdJ("click",function(){return i.matDialog.close()}),e._uU(27,"Cancel"),e.qZA()()()()),2&t){const l=e.MAs(18);e.xp6(11),e.Q6J("formGroup",i.enrollForm),e.xp6(5),e.Q6J("matAutocomplete",l),e.xp6(3),e.Q6J("ngForOf",i.filteredUsers),e.xp6(1),e.Q6J("ngIf",!i.filteredUsers.length),e.xp6(1),e.Q6J("ngIf",i.selectedOption!=i.enrollForm.controls.user.value||i.enrollForm.controls.user.hasError("required")),e.xp6(3),e.Q6J("disabled",i.enrollForm.invalid||i.selectedOption!=i.enrollForm.controls.user.value||i.apiCallActive)}},dependencies:[u.sg,u.O5,_.TO,_.KE,_.hX,q.Nt,Z.lW,T.d,E.Ye,S.Hw,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,O.ey,j.XC,j.ZL]}),o})();function rt(o,n){1&o&&(e.TgZ(0,"div",6)(1,"h1",7),e._uU(2," Enrolled Users "),e.qZA()())}function at(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"button",9),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.openEnrollUserForm())}),e._uU(2," Enroll new "),e.qZA()()}}function st(o,n){1&o&&e._UZ(0,"mat-divider",10)}function ct(o,n){if(1&o&&(e.TgZ(0,"p",11),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" There is no ","paid"==t.courseDetails.type?"enrollment requested":"user enrolled"," yet!\n")}}function dt(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1,"#"),e.qZA())}function mt(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&o){const t=n.index;e.xp6(1),e.hij(" ",t+1," ")}}function ut(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," User Name "),e.qZA())}function pt(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.ALo(2,"titlecase"),e.ALo(3,"titlecase"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",null!=t&&t.enrollmentRequestedBy?e.lcZ(2,1,null==t||null==t.enrollmentRequestedBy?null:t.enrollmentRequestedBy.fullName):e.lcZ(3,3,null==t||null==t.user?null:t.user.fullName)," ")}}function _t(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Email "),e.qZA())}function ft(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",null!=t&&t.enrollmentRequestedBy?null==t||null==t.enrollmentRequestedBy?null:t.enrollmentRequestedBy.email:null==t||null==t.user?null:t.user.email," ")}}function gt(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Enrolled On "),e.qZA())}function ht(o,n){if(1&o&&(e.TgZ(0,"td",24),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.enrolledOn,"dd/MM/yyyy")," ")}}function vt(o,n){1&o&&(e.TgZ(0,"th",23),e._uU(1," Actions "),e.qZA())}function xt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"td",24)(1,"button",25),e.NdJ("click",function(){const l=e.CHM(t),r=l.index,d=l.$implicit,m=e.oxw(2);return e.KtG(m.openConfirmDialog(r,d))}),e.TgZ(2,"mat-icon"),e._uU(3,"delete_outline"),e.qZA()()()}}function Ct(o,n){1&o&&e._UZ(0,"tr",26)}function bt(o,n){1&o&&e._UZ(0,"tr",27)}function Zt(o,n){if(1&o&&(e.TgZ(0,"div",12)(1,"table",13),e.ynx(2,14),e.YNc(3,dt,2,0,"th",15),e.YNc(4,mt,2,1,"td",16),e.BQk(),e.ynx(5,17),e.YNc(6,ut,2,0,"th",15),e.YNc(7,pt,4,5,"td",16),e.BQk(),e.ynx(8,18),e.YNc(9,_t,2,0,"th",15),e.YNc(10,ft,2,1,"td",16),e.BQk(),e.ynx(11,19),e.YNc(12,gt,2,0,"th",15),e.YNc(13,ht,3,4,"td",16),e.BQk(),e.ynx(14,20),e.YNc(15,vt,2,0,"th",15),e.YNc(16,xt,4,0,"td",16),e.BQk(),e.YNc(17,Ct,1,0,"tr",21),e.YNc(18,bt,1,0,"tr",22),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let Tt=(()=>{class o{constructor(t,i,l,r){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r,this.apiCallActive=!0}ngOnInit(){this.displayedColumns=["id","user","email","enrolledOn","action"],this.selectedCourseId=this.courseDetails._id,this.getEnrolledUsers()}getEnrolledUsers(){this.apiCallActive=!0,this.apiService.get(p.d.getEnrollments.replace(":id",this.selectedCourseId)).subscribe({next:t=>{this.apiCallActive=!1,this.dataSource=new s.by(t.enrollments||[])},error:t=>{this.apiCallActive=!1,this.errorHandlingService.handle(t)}})}openConfirmDialog(t,i,l={}){this.addEnrollmentDialogRef=this.dialog.open(F.$,{minWidth:"320px",width:"585px",disableClose:!0,data:{enrollment:i,heading:"Remove Enrollment",message:"Are you sure you want to remove this enrollment?"}}),this.addEnrollmentDialogRef.afterClosed().subscribe({next:r=>{r&&this.manageEnrollment(t,i)}})}manageEnrollment(t,i){console.log(i),this.apiService.put(p.d.manageEnrollment.replace(":id",this.selectedCourseId).replace(":enrollmentId",i._id),{isDeleted:!0}).subscribe({next:l=>{this.dataSource.data.splice(t,1),this.dataSource=new s.by(this.dataSource.data||[])},error:l=>this.errorHandlingService.handle(l)})}openEnrollUserForm(){this.addEnrollmentDialogRef=this.dialog.open(lt,{minWidth:"320px",width:"585px",disableClose:!0,data:{enrollmentId:this.selectedCourseId}}),this.addEnrollmentDialogRef.afterClosed().subscribe({next:t=>{t&&this.getEnrolledUsers()}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["manage-enrollment"]],inputs:{courseDetails:"courseDetails"},decls:6,vars:5,consts:[[1,"flex-row"],["class","title",4,"ngIf"],["class","title-buttons ",4,"ngIf"],["fxFlex","1 0",4,"ngIf"],["class","no-data flex-start",4,"ngIf"],["class","container",4,"ngIf"],[1,"title"],[1,"mat-h1"],[1,"title-buttons"],["mat-raised-button","","color","primary",3,"click"],["fxFlex","1 0"],[1,"no-data","flex-start"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","email"],["matColumnDef","enrolledOn"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn","aria-label","delete",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,rt,3,0,"div",1),e.YNc(2,at,3,0,"div",2),e.qZA(),e.YNc(3,st,1,0,"mat-divider",3),e.YNc(4,ct,2,1,"p",4),e.YNc(5,Zt,19,3,"div",5)),2&t&&(e.xp6(1),e.Q6J("ngIf",(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0),e.xp6(1),e.Q6J("ngIf","private"==i.courseDetails.type),e.xp6(1),e.Q6J("ngIf",(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)<=0),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0))},dependencies:[u.O5,Z.lW,T.d,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,S.Hw,u.rS,u.uU],styles:[".flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;padding:8px}.flex-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:50%}.flex-row[_ngcontent-%COMP%]   .title-buttons[_ngcontent-%COMP%]{margin-left:auto}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;align-content:flex-end}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%]{width:25px}"]}),o})();function yt(o,n){1&o&&(e.TgZ(0,"div",5)(1,"h1",6),e._uU(2," Enrollment Requests "),e.qZA()())}function St(o,n){1&o&&e._UZ(0,"mat-divider",7)}function Ft(o,n){1&o&&(e.TgZ(0,"p",8),e._uU(1," There is no enrollment requests yet!\n"),e.qZA())}function At(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1,"#"),e.qZA())}function wt(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.index;e.xp6(1),e.hij(" ",t+1," ")}}function qt(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," User Name "),e.qZA())}function Ut(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t||null==t.enrollmentRequestedBy?null:t.enrollmentRequestedBy.fullName)," ")}}function It(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Email "),e.qZA())}function Nt(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",null==t||null==t.enrollmentRequestedBy?null:t.enrollmentRequestedBy.email," ")}}function Mt(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Requested On "),e.qZA())}function Dt(o,n){if(1&o&&(e.TgZ(0,"td",22),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.enrollmentRequestedOn,"dd/MM/yyyy")," ")}}function kt(o,n){1&o&&(e.TgZ(0,"th",21),e._uU(1," Actions "),e.qZA())}function Yt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const l=e.oxw(),r=l.index,d=l.$implicit,m=e.oxw(2);return e.KtG(m.manageRequest(r,d,"Accept"))}),e._uU(1," Accept "),e.TgZ(2,"mat-icon"),e._uU(3,"check circle"),e.qZA()()}}function Et(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const l=e.oxw(),r=l.index,d=l.$implicit,m=e.oxw(2);return e.KtG(m.manageRequest(r,d,"Decline"))}),e._uU(1," Decline "),e.TgZ(2,"mat-icon"),e._uU(3,"close circle"),e.qZA()()}}function Ot(o,n){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"titlecase"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t.requestStatus))}}function Jt(o,n){if(1&o&&(e.TgZ(0,"td",23),e.YNc(1,Yt,4,0,"button",24),e.YNc(2,Et,4,0,"button",25),e.YNc(3,Ot,3,3,"span",26),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf","pending"===t.requestStatus),e.xp6(1),e.Q6J("ngIf","pending"===t.requestStatus),e.xp6(1),e.Q6J("ngIf","pending"!==t.requestStatus)}}function Lt(o,n){1&o&&e._UZ(0,"tr",29)}function Pt(o,n){1&o&&e._UZ(0,"tr",30)}function Qt(o,n){if(1&o&&(e.TgZ(0,"div",9)(1,"table",10),e.ynx(2,11),e.YNc(3,At,2,0,"th",12),e.YNc(4,wt,2,1,"td",13),e.BQk(),e.ynx(5,14),e.YNc(6,qt,2,0,"th",12),e.YNc(7,Ut,3,3,"td",13),e.BQk(),e.ynx(8,15),e.YNc(9,It,2,0,"th",12),e.YNc(10,Nt,2,1,"td",13),e.BQk(),e.ynx(11,16),e.YNc(12,Mt,2,0,"th",12),e.YNc(13,Dt,3,4,"td",13),e.BQk(),e.ynx(14,17),e.YNc(15,kt,2,0,"th",12),e.YNc(16,Jt,4,3,"td",18),e.BQk(),e.YNc(17,Lt,1,0,"tr",19),e.YNc(18,Pt,1,0,"tr",20),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.dataSource),e.xp6(16),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}let Rt=(()=>{class o{constructor(t,i,l,r){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r,this.apiCallActive=!0}ngOnInit(){this.displayedColumns=["id","user","email","enrollmentRequestedOn","action"],this.selectedCourseId=this.courseDetails._id,this.getEnrollmentRequests()}getEnrollmentRequests(){this.apiCallActive=!0,this.apiService.get(p.d.getEnrollmentRequests.replace(":id",this.selectedCourseId)).subscribe({next:t=>{this.apiCallActive=!1,this.dataSource=new s.by(t.enrollmentRequests||[])},error:t=>{this.apiCallActive=!1,this.errorHandlingService.handle(t)}})}manageRequest(t,i,l){this.openConfirmDialog(t,i,{request:i,action:l,heading:l+" Enrollment Request",message:"Are you sure you want to "+l.toLowerCase()+" this course enrollment request?"})}openConfirmDialog(t,i,l={}){this.manageRequestDialogRef=this.dialog.open(F.$,{minWidth:"320px",width:"585px",disableClose:!0,data:l}),this.manageRequestDialogRef.afterClosed().subscribe({next:r=>{r&&this.manageEnrollRequest(t,i,l)}})}manageEnrollRequest(t,i,l){this.apiService.put(p.d.manageEnrollmentRequest.replace(":id",this.selectedCourseId).replace(":enrollmentId",i._id),{isEnrolled:"accept"==l.action.toLowerCase()}).subscribe({next:r=>{this.getEnrollmentRequests(),this.alertService.notify(r.message)},error:r=>this.errorHandlingService.handle(r)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c))},o.\u0275cmp=e.Xpm({type:o,selectors:[["manage-enrollment-requests"]],inputs:{courseDetails:"courseDetails"},decls:5,vars:4,consts:[[1,"flex-row"],["class","title",4,"ngIf"],["fxFlex","1 0",4,"ngIf"],["class","no-data flex-start",4,"ngIf"],["class","container",4,"ngIf"],[1,"title"],[1,"mat-h1"],["fxFlex","1 0"],[1,"no-data","flex-start"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","user"],["matColumnDef","email"],["matColumnDef","enrollmentRequestedOn"],["matColumnDef","action"],["mat-cell","","class","action-buttons",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"action-buttons"],["mat-icon-button","","color","primary","aria-label","view",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","aria-label","delete",3,"click",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","color","primary","aria-label","view",3,"click"],["mat-icon-button","","color","warn","aria-label","delete",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,yt,3,0,"div",1),e.qZA(),e.YNc(2,St,1,0,"mat-divider",2),e.YNc(3,Ft,2,0,"p",3),e.YNc(4,Qt,19,3,"div",4)),2&t&&(e.xp6(1),e.Q6J("ngIf",(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0),e.xp6(1),e.Q6J("ngIf",(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)<=0),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)>0))},dependencies:[u.O5,Z.lW,T.d,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk,S.Hw,u.rS,u.uU],styles:[".flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;padding:8px}.flex-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:50%}.flex-row[_ngcontent-%COMP%]   .title-buttons[_ngcontent-%COMP%]{margin-left:auto}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:80px;margin-right:20px}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{align-content:flex-end}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:220px!important}"]}),o})();function jt(o,n){if(1&o&&(e.TgZ(0,"h1",7)(1,"a",8),e._uU(2,"Course List"),e.qZA(),e._uU(3," > "),e.TgZ(4,"i"),e._uU(5),e.ALo(6,"titlecase"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.MGl("routerLink","/dashboard/course/list/",null==t.courseDetails?null:t.courseDetails.type,""),e.xp6(4),e.Oqu(e.lcZ(6,2,null==t.courseDetails?null:t.courseDetails.name))}}function Ht(o,n){1&o&&(e.TgZ(0,"p",9),e._uU(1," Course details not found!\n"),e.qZA())}function zt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"a",13),e.NdJ("click",function(){e.CHM(t);const l=e.oxw(2);return e.KtG(l.activeSlide=4)}),e._uU(1," Enrollment Requests "),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("active",4==t.activeSlide)}}function Bt(o,n){1&o&&(e.TgZ(0,"div"),e._UZ(1,"slide-list"),e.qZA())}function Vt(o,n){1&o&&(e.TgZ(0,"div",18),e._uU(1,"No comments found"),e.qZA())}function Gt(o,n){if(1&o&&(e.TgZ(0,"mat-card"),e._UZ(1,"comment",19),e.qZA()),2&o){const t=n.$implicit;e.xp6(1),e.Q6J("comment",t)}}function $t(o,n){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,Vt,2,0,"div",16),e.YNc(2,Gt,2,1,"mat-card",17),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!(null!=t.rootComments&&t.rootComments.length)),e.xp6(1),e.Q6J("ngForOf",t.rootComments)}}function Kt(o,n){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"manage-enrollment",20),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("courseDetails",t.courseDetails)}}function Wt(o,n){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"manage-enrollment-requests",20),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("courseDetails",t.courseDetails)}}function Xt(o,n){if(1&o){const t=e.EpF();e.TgZ(0,"div",10)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e._uU(4),e.ALo(5,"titlecase"),e.qZA()(),e.TgZ(6,"mat-card-content")(7,"div",11)(8,"p"),e._uU(9),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"nav",12)(13,"a",13),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.activeSlide=1)}),e._uU(14," Slides "),e.qZA(),e.TgZ(15,"a",13),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.activeSlide=2)}),e._uU(16," Comments "),e.qZA(),e.TgZ(17,"a",13),e.NdJ("click",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.activeSlide=3)}),e._uU(18," Enrollments "),e.qZA(),e.YNc(19,zt,2,1,"a",14),e.qZA(),e.YNc(20,Bt,2,0,"div",15),e.YNc(21,$t,3,2,"div",15),e.YNc(22,Kt,2,1,"div",15),e.YNc(23,Wt,2,1,"div",15),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Oqu(e.lcZ(5,11,t.courseDetails.name)),e.xp6(5),e.Oqu(t.courseDetails.description),e.xp6(2),e.hij("Published: ",t.courseDetails.isPublished?"Yes":"No",""),e.xp6(2),e.Q6J("active",1==t.activeSlide),e.xp6(2),e.Q6J("active",2==t.activeSlide),e.xp6(2),e.Q6J("active",3==t.activeSlide),e.xp6(2),e.Q6J("ngIf","paid"==(null==t.courseDetails?null:t.courseDetails.type)),e.xp6(1),e.Q6J("ngIf",1==t.activeSlide),e.xp6(1),e.Q6J("ngIf",2==t.activeSlide),e.xp6(1),e.Q6J("ngIf",3==t.activeSlide),e.xp6(1),e.Q6J("ngIf",4==t.activeSlide&&"paid"==(null==t.courseDetails?null:t.courseDetails.type))}}let ei=(()=>{class o{constructor(t,i,l,r,d){this.apiService=t,this.dialog=i,this.errorHandlingService=l,this.alertService=r,this.activeRoute=d,this.activeSlide=1,this.apiCallActive=!0,this.rootComments=[],this.activeRoute.params.subscribe({next:m=>{this.selectedCourseId=m.id,this.getCourseDetails()}})}ngOnInit(){}getCourseDetails(){this.apiCallActive=!0,this.apiService.get(p.d.getCourseDetails+this.selectedCourseId).subscribe({next:t=>{this.apiCallActive=!1,this.courseDetails=t.course,this.rootComments=this.courseDetails.rootComments},error:t=>{this.apiCallActive=!1,this.errorHandlingService.handle(t)}})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(x.a),e.Y36(f.uw),e.Y36(C.r),e.Y36(b.c),e.Y36(v.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-course-details"]],decls:7,vars:3,consts:[[1,"title-group"],[1,"title"],["class","mat-h1",4,"ngIf"],[1,"title-buttons"],["fxFlex","1 0"],["class","no-data",4,"ngIf"],["class","container",4,"ngIf"],[1,"mat-h1"],[1,"link",3,"routerLink"],[1,"no-data"],[1,"container"],[1,"details-container"],["mat-tab-nav-bar",""],["mat-tab-link","",3,"active","click"],["mat-tab-link","",3,"active","click",4,"ngIf"],[4,"ngIf"],["class","no-data flex-start",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"no-data","flex-start"],[3,"comment"],[3,"courseDetails"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,jt,7,4,"h1",2),e.qZA(),e._UZ(3,"div",3),e.qZA(),e._UZ(4,"mat-divider",4),e.YNc(5,Ht,2,0,"p",5),e.YNc(6,Xt,24,13,"div",6)),2&t&&(e.xp6(2),e.Q6J("ngIf",null==i.courseDetails?null:i.courseDetails.name),e.xp6(3),e.Q6J("ngIf",!(i.apiCallActive||null!=i.courseDetails&&i.courseDetails._id)),e.xp6(1),e.Q6J("ngIf",!i.apiCallActive&&(null==i.courseDetails?null:i.courseDetails._id)))},dependencies:[v.yS,u.sg,u.O5,I.a8,I.dk,I.dn,I.n5,T.d,U.BU,U.Nj,We,tt,Tt,Rt,u.rS],styles:[".comment{display:grid;gap:14px;margin-top:15px}.comment .user-banner{display:flex;justify-content:space-between}.comment .user-banner .avatar{height:55px;width:55px;border-radius:50%;vertical-align:middle;display:flex;align-items:center;justify-content:center;margin-right:12px;line-height:20px}.comment .user-banner .avatar img{max-width:100%;border-radius:50%}.comment .user-banner .user{align-items:center;display:flex;width:100%;margin-bottom:8px;flex-wrap:wrap}.comment .user-banner .user h5{font-size:16px;color:#000;font-weight:500;line-height:17px;margin-bottom:0}.comment .user-banner .user span{font-size:14px;font-weight:400;overflow-wrap:break-word}.comment .user-banner .user .reply{margin-left:auto;color:#007bff;text-decoration:none}.comment .user-banner .user .stat{display:flex;position:absolute;right:-2px;bottom:-2px;display:block;width:12px;height:12px;z-index:9;border:2px solid #ffffff;border-radius:100px}.comment .user-banner .user .stat.green{background:#00ba34}.comment .user-banner .user .stat.grey{background:#969696}.comment .user-banner .content{font-size:14px;font-weight:400;overflow-wrap:break-word;flex-basis:100%}.comment .footer{gap:12px;display:flex;align-items:center}.comment .footer .reactions{display:flex;align-items:center;gap:8px}.comment .footer .divider{height:12px;width:1px;background:#e8e8e8}.comment:not(.comment:first-child){padding-bottom:8px;margin-bottom:8px;border-bottom:1px solid #e8e8e8}.mat-card-header-text{margin:0!important}\n"],encapsulation:2}),o})();var ti=a(8427),ii=a(4111);const oi=[{path:"list/:type",component:be},{path:"details/:id",component:ei},{path:"**",redirectTo:"list"}];let ni=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[v.Bz.forChild(oi),u.ez,ti.q,ii.q,A._t]}),o})()}}]);