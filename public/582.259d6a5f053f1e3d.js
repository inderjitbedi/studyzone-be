"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[582],{1582:(mt,_,r)=>{r.r(_),r.d(_,{UserModule:()=>lt});var d=r(6895),l=r(7155),u=r(9938),T=r(9302),s=r(4006),f=r(7368),A=r(8372),y=r(5e3),t=r(4650),h=r(8606),g=r(3263),I=r(2510),U=r(5412),v=r(9549),D=r(4144),C=r(4859),x=r(4850),F=r(3683),b=r(7392);function N(i,o){if(1&i&&(t.TgZ(0,"mat-form-field"),t._UZ(1,"input",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("value",null==e.userDetails?null:e.userDetails.fullName)}}function S(i,o){if(1&i&&(t.TgZ(0,"mat-form-field"),t._UZ(1,"input",16),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("value",null==e.userDetails?null:e.userDetails.role)}}function Y(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1,"Required "),t.qZA())}function L(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Email already exists. "),t.qZA())}function J(i,o){1&i&&(t.TgZ(0,"mat-error"),t._uU(1," Invalid Email. "),t.qZA())}function Q(i,o){1&i&&t._UZ(0,"span",24)}function q(i,o){1&i&&(t.TgZ(0,"span",25),t._uU(1,"Loading..."),t.qZA())}function w(i,o){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.hij(" ",null!=e.userDetails&&e.userDetails._id?"Reinvite":"Invite","")}}function O(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.inviteUser())}),t.YNc(1,Q,1,0,"span",22),t.YNc(2,q,2,0,"span",23),t.YNc(3,w,2,1,"span",11),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",e.inviteUserForm.invalid||e.apiCallActive),t.xp6(1),t.Q6J("ngIf",e.apiCallActive),t.xp6(1),t.Q6J("ngIf",e.apiCallActive),t.xp6(1),t.Q6J("ngIf",!e.apiCallActive)}}function M(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"mat-toolbar",17)(1,"div",18),t.YNc(2,O,4,4,"button",19),t.TgZ(3,"button",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.matDialog.close())}),t._uU(4,"Cancel"),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.userDetails.isSignedUp)}}let E=(()=>{class i{constructor(e,n,a,m,c,p,st){this.matDialog=e,this.data=n,this.apiService=a,this.errorHandlingService=m,this.matcher=c,this.fb=p,this.alertService=st,this.userDetails={},this.apiCallActive=!1,this.isViewOnly=!1,this.userDetails=n.user,this.inviteUserForm=this.fb.group({email:[n?.user?.email||"",[s.kI.required,s.kI.pattern(y.c.emailValidator.pattern)]]}),this.inviteUserForm.controls.email.valueChanges.pipe((0,A.b)(500)).subscribe({next:ct=>{this.checkEmailUniqueness()}})}ngOnInit(){}inviteUser(){if(this.inviteUserForm.valid){this.apiCallActive=!0;let e={email:this.inviteUserForm.value.email},n=u.d.inviteUser;!this.userDetails?.isSignedUp&&this.userDetails?._id&&(n=u.d.reinviteUser,e._id=this.userDetails?._id),this.apiService.post(n,e).subscribe({next:a=>{this.alertService.notify(a.message),this.matDialog.close(a)},error:a=>{this.errorHandlingService.handle(a)},complete:()=>{this.apiCallActive=!1}})}}checkEmailUniqueness(){let e=this.inviteUserForm.controls.email;e.valid&&e.value.trim()&&e.value.trim()!=this.userDetails?.email&&(this.apiCallActive=!0,this.apiService.get(u.d.checkEmailUniqueness+e.value.trim().toLowerCase()).subscribe({next:n=>{this.apiCallActive=!1,!1===n.isUnique?e.setErrors({not_unique:!0}):this.inviteUserForm.controls.email.errors&&delete this.inviteUserForm.controls.email.errors.not_unique},error:n=>{this.apiCallActive=!1,this.errorHandlingService.handle(n)}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(f.so),t.Y36(f.WI),t.Y36(h.a),t.Y36(g.r),t.Y36(I.d),t.Y36(s.qu),t.Y36(U.c))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-invite-user-form"]],decls:24,vars:16,consts:[["fxLayout","column",1,"container-div"],["fxLayoutAlign","end flex-end",1,"mat-accent-bg","m-0"],["fxFlex","100","fxLayout","row","fxLayoutAlign","space-between flex-end",1,"mat-toolbar-header"],[1,"title","dialog-title"],["aria-label","Close dialog","mat-button","",1,"mat-icon-button","mat-button",3,"click"],[1,"mat-button-wrapper"],["role","img","aria-hidden","true",1,"mat-icon","material-icons"],[1,"mt-10"],["fxLayout","column",1,"content","p-20","mt-20"],["fx-layout","column",3,"formGroup"],["fxLayout","column","fxLayout.gt-xs","row"],[4,"ngIf"],["fxFlex","100"],["type","text","matInput","","formControlName","email","trim","","autocomplete","off",3,"errorStateMatcher","readonly"],["class","mat-accent-bg m-0 mt-12","fxLayoutAlign","center",4,"ngIf"],["type","text","matInput","","placeholder","Name","readonly","",3,"value"],["type","text","matInput","","placeholder","Role","readonly","",3,"value"],["fxLayoutAlign","center",1,"mat-accent-bg","m-0","mt-12"],["fxlayout","row","fxLayoutAlign","flex-end","fxFlex","100",1,"mat-toolbar-footer","action-buttons"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click",4,"ngIf"],["type","button","mat-raised-button","",1,"mr-20",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],["class","sr-only",4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"sr-only"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"div",2)(3,"span",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return n.matDialog.close()}),t.TgZ(6,"span",5)(7,"mat-icon",6),t._uU(8,"close"),t.qZA()()()()(),t._UZ(9,"mat-divider",7),t.TgZ(10,"div",8)(11,"form",9)(12,"div",10),t.YNc(13,N,2,1,"mat-form-field",11),t.YNc(14,S,2,1,"mat-form-field",11),t.TgZ(15,"div",10)(16,"mat-form-field",12)(17,"mat-label"),t._uU(18,"Email "),t.qZA(),t._UZ(19,"input",13),t.YNc(20,Y,2,0,"mat-error",11),t.YNc(21,L,2,0,"mat-error",11),t.YNc(22,J,2,0,"mat-error",11),t.qZA()()()()(),t.YNc(23,M,5,1,"mat-toolbar",14),t.qZA()),2&e&&(t.xp6(4),t.Oqu(null!=n.userDetails&&n.userDetails.isSignedUp?"User Details":null!=n.userDetails&&n.userDetails._id?"Reinvite User":"Invite User"),t.xp6(7),t.Q6J("formGroup",n.inviteUserForm),t.xp6(1),t.ekj("form-div",!n.isViewOnly)("mt-30",n.isViewOnly),t.xp6(1),t.Q6J("ngIf",n.userDetails.fullName),t.xp6(1),t.Q6J("ngIf",n.userDetails.role),t.xp6(2),t.ekj("mb-10",n.inviteUserForm.controls.email.touched&&n.inviteUserForm.controls.email.hasError("required")),t.xp6(3),t.Q6J("errorStateMatcher",n.matcher)("readonly",null==n.userDetails?null:n.userDetails.isSignedUp),t.xp6(1),t.Q6J("ngIf",n.inviteUserForm.controls.email.hasError("required")),t.xp6(1),t.Q6J("ngIf",!n.inviteUserForm.controls.email.hasError("required")&&!n.inviteUserForm.controls.email.hasError("pattern")&&n.inviteUserForm.controls.email.hasError("not_unique")),t.xp6(1),t.Q6J("ngIf",!n.inviteUserForm.controls.email.hasError("required")&&n.inviteUserForm.controls.email.hasError("pattern")),t.xp6(1),t.Q6J("ngIf",!n.isViewOnly))},dependencies:[d.O5,v.TO,v.KE,v.hX,D.Nt,C.lW,x.d,F.Ye,b.Hw,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u]}),i})();var Z=r(9299);function k(i,o){1&i&&(t.TgZ(0,"p",8),t._uU(1," There is no User created yet!\n"),t.qZA())}function H(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1,"#"),t.qZA())}function R(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.index;t.xp6(1),t.hij(" ",e+1," ")}}function P(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1," Name "),t.qZA())}function j(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,null!=e&&e.firstName?(null==e?null:e.firstName)+" "+(null==e?null:e.lastName):null==e?null:e.fullName)," ")}}function B(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1," Email "),t.qZA())}function G(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.email," ")}}function $(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1," Has signed up? "),t.qZA())}function V(i,o){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.hij(" ",e.isSignedUp?"Yes":"No"," ")}}function z(i,o){1&i&&(t.TgZ(0,"th",20),t._uU(1," Actions "),t.qZA())}function K(i,o){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"lock"),t.qZA())}function W(i,o){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"lock_open"),t.qZA())}function X(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"td",21)(1,"button",22),t.NdJ("click",function(){const m=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.openUserInviteForm(!0,m))}),t.TgZ(2,"mat-icon"),t._uU(3,"visibility"),t.qZA()(),t.TgZ(4,"button",23),t.NdJ("click",function(){const a=t.CHM(e),m=a.index,c=a.$implicit,p=t.oxw(2);return t.KtG(p.openConfirmDialog(m,c))}),t.YNc(5,K,2,0,"mat-icon",24),t.YNc(6,W,2,0,"mat-icon",24),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(5),t.Q6J("ngIf",e.isSignedUp&&e.isActive),t.xp6(1),t.Q6J("ngIf",e.isSignedUp&&!e.isActive)}}function tt(i,o){1&i&&t._UZ(0,"tr",25)}function et(i,o){1&i&&t._UZ(0,"tr",26)}function it(i,o){if(1&i&&(t.TgZ(0,"div",9)(1,"table",10),t.ynx(2,11),t.YNc(3,H,2,0,"th",12),t.YNc(4,R,2,1,"td",13),t.BQk(),t.ynx(5,14),t.YNc(6,P,2,0,"th",12),t.YNc(7,j,3,3,"td",13),t.BQk(),t.ynx(8,15),t.YNc(9,B,2,0,"th",12),t.YNc(10,G,2,1,"td",13),t.BQk(),t.ynx(11,16),t.YNc(12,$,2,0,"th",12),t.YNc(13,V,2,1,"td",13),t.BQk(),t.ynx(14,17),t.YNc(15,z,2,0,"th",12),t.YNc(16,X,7,2,"td",13),t.BQk(),t.YNc(17,tt,1,0,"tr",18),t.YNc(18,et,1,0,"tr",19),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("dataSource",e.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let nt=(()=>{class i{constructor(e,n,a,m,c){this.apiService=e,this.dialog=n,this.errorHandlingService=a,this.alertService=m,this.activeRoute=c,this.apiCallActive=!0,this.displayedColumns=["id","fullName","email","isSignedUp","action"],this.activeRoute.params.subscribe({next:p=>{this.getUsers()}})}ngOnInit(){}openConfirmDialog(e,n){this.addUserDialogRef=this.dialog.open(T.$,{minWidth:"320px",width:"585px",disableClose:!0,data:{user:n,heading:(n.isActive?"Deactivate":"Activate")+" User",message:"Are you sure you want to "+(n.isActive?"de":"")+"activate this user?"}}),this.addUserDialogRef.afterClosed().subscribe({next:a=>{a&&this.manageUser(e,n)}})}openUserInviteForm(e,n={}){this.addUserDialogRef=this.dialog.open(E,{minWidth:"320px",width:"585px",disableClose:!0,data:{isViewOnly:e,user:n}}),this.addUserDialogRef.afterClosed().subscribe({next:a=>{a&&this.getUsers()}})}getUsers(){this.apiCallActive=!0,this.apiService.get(u.d.user).subscribe({next:e=>{this.apiCallActive=!1,this.dataSource=new l.by(e.users||[])},error:e=>{this.apiCallActive=!1,this.errorHandlingService.handle(e)}})}manageUser(e,n){this.apiService.put(u.d.manageUserAccess,{email:n.email,isActive:!n.isActive}).subscribe({next:a=>{this.dataSource.data[e].isActive=!this.dataSource.data[e].isActive,this.alertService.notify(a.message)},error:a=>this.errorHandlingService.handle(a)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.a),t.Y36(f.uw),t.Y36(g.r),t.Y36(U.c),t.Y36(Z.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-user-list"]],decls:10,vars:2,consts:[[1,"title-group"],[1,"title"],[1,"mat-h1"],[1,"title-buttons"],["mat-raised-button","","color","primary",3,"click"],["fxFlex","1 0"],["class","no-data",4,"ngIf"],["class","container",4,"ngIf"],[1,"no-data"],[1,"container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullName"],["matColumnDef","email"],["matColumnDef","isSignedUp"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary","aria-label","view",3,"click"],["mat-icon-button","","color","warn","aria-label","delete",3,"click"],[4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3," User List "),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return n.openUserInviteForm(!1)}),t._uU(6," Invite user "),t.qZA()()(),t._UZ(7,"mat-divider",5),t.YNc(8,k,2,0,"p",6),t.YNc(9,it,19,3,"div",7)),2&e&&(t.xp6(8),t.Q6J("ngIf",!n.apiCallActive&&(null==n.dataSource||null==n.dataSource.filteredData?null:n.dataSource.filteredData.length)<=0),t.xp6(1),t.Q6J("ngIf",!n.apiCallActive&&(null==n.dataSource||null==n.dataSource.filteredData?null:n.dataSource.filteredData.length)>0))},dependencies:[d.O5,C.lW,x.d,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,b.Hw,d.rS],styles:["table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:50px;word-break:break-all}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child, table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{width:100px;align-content:flex-end}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child   .mat-icon-button[_ngcontent-%COMP%]{width:25px}"]}),i})();var ot=r(4111),at=r(8427);const rt=[{path:"list",component:nt},{path:"**",redirectTo:"list"}];let lt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[Z.Bz.forChild(rt),d.ez,at.q,ot.q]}),i})()}}]);